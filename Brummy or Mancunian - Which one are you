{
    "cells": [
        {
            "cell_type": "markdown",
            "metadata": {
                "collapsed": true
            },
            "source": "# Brummy or Mancunian - which one are you? [Birmingham|Manchester]"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Introduction\n\nWhen we think of UK, we think of London. Although a great place to visit, London isn\u2019t necessarily affordable by everyone as a place to live. Due to this, many prefer living in a city close to London so that not only can they live in a bigger house for a lower rent, and save on many other things while earning a decent income, but also can drop in London within an hour or two. Smart.\n\nA problem with this approach is that if you just want a quick night-out, maybe go to a fancy restaurant, or visit a museum, or a park, you shouldn\u2019t have to sit in a train for over an hour, every single time. The city you choose should have things to do that you prefer.\n\nWhat then, is the next best thing? \n\nA quick Google search revealed people prefer either Birmingham or Manchester. Many say Birmingham\u2019s better, even better than London, while many side with Manchester. \n\nBut which one\u2019s better for you?\n"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Data\n\nI will use Foursquare to explore both the cities. This should help a person select the city they\u2019d like to live in.\n\nI will then use Foursquare to explore the neighborhoods to help the person select a place to call home.\n\nI will get the list of postal codes and neighborhoods from the following:\n\nBirmingham - https://en.wikipedia.org/wiki/B_postcode_area\n\nManchester - https://en.wikipedia.org/wiki/M_postcode_area\n\nThey have details about the \u2018Postal district\u2019, \u2018Post town\u2019, \u2018Coverage\u2019, \u2018Local Authority Area\u2019.\n\nI will use \u2018Post town\u2019 to filter the data and select only \u2018BIRMINGHAM\u2019 and \u2018MANCHESTER\u2019, respectively. \n\nI will use \u2018Coverage\u2019 (Neighborhoods) to get the latitudes and longitudes needed, using geocoder."
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Disclaimer\n\nI am doing this project to learn. Needless to say, I strongly advise you against using this to make a major life decision!\n\nBut yes, feel free to go through the notebook and let me know what you think."
        },
        {
            "cell_type": "code",
            "execution_count": 3,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "Solving environment: done\n\n## Package Plan ##\n\n  environment location: /opt/conda/envs/Python36\n\n  added / updated specs: \n    - folium=0.5.0\n\n\nThe following packages will be downloaded:\n\n    package                    |            build\n    ---------------------------|-----------------\n    folium-0.5.0               |             py_0          45 KB  conda-forge\n    openssl-1.1.1g             |       h516909a_0         2.1 MB  conda-forge\n    branca-0.4.1               |             py_0          26 KB  conda-forge\n    python_abi-3.6             |          1_cp36m           4 KB  conda-forge\n    vincent-0.4.4              |             py_1          28 KB  conda-forge\n    certifi-2020.4.5.1         |   py36h9f0ad1d_0         151 KB  conda-forge\n    altair-4.1.0               |             py_1         614 KB  conda-forge\n    ca-certificates-2020.4.5.1 |       hecc5488_0         146 KB  conda-forge\n    ------------------------------------------------------------\n                                           Total:         3.1 MB\n\nThe following NEW packages will be INSTALLED:\n\n    altair:          4.1.0-py_1        conda-forge\n    branca:          0.4.1-py_0        conda-forge\n    folium:          0.5.0-py_0        conda-forge\n    python_abi:      3.6-1_cp36m       conda-forge\n    vincent:         0.4.4-py_1        conda-forge\n\nThe following packages will be UPDATED:\n\n    ca-certificates: 2020.1.1-0                    --> 2020.4.5.1-hecc5488_0     conda-forge\n    certifi:         2020.4.5.1-py36_0             --> 2020.4.5.1-py36h9f0ad1d_0 conda-forge\n    openssl:         1.1.1g-h7b6447c_0             --> 1.1.1g-h516909a_0         conda-forge\n\n\nDownloading and Extracting Packages\nfolium-0.5.0         | 45 KB     | ##################################### | 100% \nopenssl-1.1.1g       | 2.1 MB    | ##################################### | 100% \nbranca-0.4.1         | 26 KB     | ##################################### | 100% \npython_abi-3.6       | 4 KB      | ##################################### | 100% \nvincent-0.4.4        | 28 KB     | ##################################### | 100% \ncertifi-2020.4.5.1   | 151 KB    | ##################################### | 100% \naltair-4.1.0         | 614 KB    | ##################################### | 100% \nca-certificates-2020 | 146 KB    | ##################################### | 100% \nPreparing transaction: done\nVerifying transaction: done\nExecuting transaction: done\n"
                }
            ],
            "source": "import pandas as pd\nimport numpy as np\nimport requests\nfrom pandas.io.json import json_normalize\nfrom sklearn.cluster import KMeans\nfrom matplotlib import cm\nfrom matplotlib import colors\n\nfrom geopy.geocoders import Nominatim\nfrom geopy.extra.rate_limiter import RateLimiter\n\n#!conda install -c conda-forge folium=0.5.0 --yes\nimport folium"
        },
        {
            "cell_type": "code",
            "execution_count": 5,
            "metadata": {},
            "outputs": [],
            "source": "# The code was removed by Watson Studio for sharing."
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Prepare Birmingham dataset"
        },
        {
            "cell_type": "code",
            "execution_count": 6,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Postcode district</th>\n      <th>Post town</th>\n      <th>Coverage</th>\n      <th>Local authority area</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>B1</td>\n      <td>BIRMINGHAM</td>\n      <td>Birmingham City Centre, Broad Street (east)</td>\n      <td>Birmingham</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>B2</td>\n      <td>BIRMINGHAM</td>\n      <td>Birmingham City Centre, New Street</td>\n      <td>Birmingham</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>B3</td>\n      <td>BIRMINGHAM</td>\n      <td>Birmingham City Centre, Newhall Street</td>\n      <td>Birmingham</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>B4</td>\n      <td>BIRMINGHAM</td>\n      <td>Birmingham City Centre, Corporation Street (no...</td>\n      <td>Birmingham</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>B5</td>\n      <td>BIRMINGHAM</td>\n      <td>Digbeth, Highgate, Lee Bank</td>\n      <td>Birmingham</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "  Postcode district   Post town  \\\n0                B1  BIRMINGHAM   \n1                B2  BIRMINGHAM   \n2                B3  BIRMINGHAM   \n3                B4  BIRMINGHAM   \n4                B5  BIRMINGHAM   \n\n                                            Coverage Local authority area  \n0        Birmingham City Centre, Broad Street (east)           Birmingham  \n1                 Birmingham City Centre, New Street           Birmingham  \n2             Birmingham City Centre, Newhall Street           Birmingham  \n3  Birmingham City Centre, Corporation Street (no...           Birmingham  \n4                        Digbeth, Highgate, Lee Bank           Birmingham  "
                    },
                    "execution_count": 6,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "list=[]\ndfs = pd.read_html('https://en.wikipedia.org/wiki/B_postcode_area',header=0)\nbir = dfs[1]\nbir.head()"
        },
        {
            "cell_type": "code",
            "execution_count": 7,
            "metadata": {
                "scrolled": true
            },
            "outputs": [
                {
                    "data": {
                        "text/plain": "BIRMINGHAM          46\nSOLIHULL             5\nSUTTON COLDFIELD     5\nTAMWORTH             3\nREDDITCH             3\nBROMSGROVE           2\nALCESTER             2\nWEST BROMWICH        2\nSMETHWICK            2\nOLDBURY              2\nHALESOWEN            2\nHENLEY-IN-ARDEN      1\nCRADLEY HEATH        1\nROWLEY REGIS         1\nSTUDLEY              1\nName: Post town, dtype: int64"
                    },
                    "execution_count": 7,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "bir['Post town'].value_counts()"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "Let's select only Birmingham."
        },
        {
            "cell_type": "code",
            "execution_count": 8,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "BIRMINGHAM    46\nName: Post town, dtype: int64"
                    },
                    "execution_count": 8,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "bir = bir[bir['Post town'] == 'BIRMINGHAM']\nbir['Post town'].value_counts()"
        },
        {
            "cell_type": "code",
            "execution_count": 9,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "Postcode district       0\nPost town               0\nCoverage                1\nLocal authority area    0\ndtype: int64"
                    },
                    "execution_count": 9,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "bir.isnull().sum()"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "There is one null value. Drop it."
        },
        {
            "cell_type": "code",
            "execution_count": 10,
            "metadata": {},
            "outputs": [
                {
                    "name": "stderr",
                    "output_type": "stream",
                    "text": "/opt/conda/envs/Python36/lib/python3.6/site-packages/ipykernel/__main__.py:1: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame\n\nSee the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n  if __name__ == '__main__':\n"
                },
                {
                    "data": {
                        "text/plain": "Postcode district       0\nPost town               0\nCoverage                0\nLocal authority area    0\ndtype: int64"
                    },
                    "execution_count": 10,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "bir.dropna(subset=['Coverage'],inplace=True)\nbir.isnull().sum()"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "Now, let's add the coordinates."
        },
        {
            "cell_type": "code",
            "execution_count": 11,
            "metadata": {},
            "outputs": [
                {
                    "name": "stderr",
                    "output_type": "stream",
                    "text": "/opt/conda/envs/Python36/lib/python3.6/site-packages/ipykernel/__main__.py:7: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n"
                }
            ],
            "source": "locator = Nominatim(user_agent=\"myGeocoder\")\n\n# 1 - conveneint function to delay between geocoding calls\ngeocode = RateLimiter(locator.geocode, min_delay_seconds=1)\n\n# 2- - create location column\nbir['location'] = bir['Coverage'].apply(geocode)"
        },
        {
            "cell_type": "code",
            "execution_count": 12,
            "metadata": {},
            "outputs": [
                {
                    "name": "stderr",
                    "output_type": "stream",
                    "text": "/opt/conda/envs/Python36/lib/python3.6/site-packages/ipykernel/__main__.py:2: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n  from ipykernel import kernelapp as app\n/opt/conda/envs/Python36/lib/python3.6/site-packages/ipykernel/__main__.py:5: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame\n\nSee the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n/opt/conda/envs/Python36/lib/python3.6/site-packages/pandas/core/frame.py:3391: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n  self[k1] = value[k2]\n"
                }
            ],
            "source": "# 3 - create longitude, laatitude and altitude from location column (returns tuple)\nbir['point'] = bir['location'].apply(lambda loc: tuple(loc.point) if loc else None)\n\n# 4 - drop null values\nbir.dropna(subset=['location','point'],inplace=True)\n\n# 5 - split point column into latitude, longitude and altitude columns\nbir[['latitude', 'longitude', 'altitude']] = pd.DataFrame(bir['point'].tolist(), index=bir.index)"
        },
        {
            "cell_type": "code",
            "execution_count": 13,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Postcode district</th>\n      <th>Post town</th>\n      <th>Coverage</th>\n      <th>Local authority area</th>\n      <th>location</th>\n      <th>point</th>\n      <th>latitude</th>\n      <th>longitude</th>\n      <th>altitude</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>B2</td>\n      <td>BIRMINGHAM</td>\n      <td>Birmingham City Centre, New Street</td>\n      <td>Birmingham</td>\n      <td>(New Street, Digbeth, Birmingham, West Midland...</td>\n      <td>(52.4792602, -1.8999756, 0.0)</td>\n      <td>52.479260</td>\n      <td>-1.899976</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>B3</td>\n      <td>BIRMINGHAM</td>\n      <td>Birmingham City Centre, Newhall Street</td>\n      <td>Birmingham</td>\n      <td>(Newhall Street, Jewellery Quarter, Birmingham...</td>\n      <td>(52.4832071, -1.9054204, 0.0)</td>\n      <td>52.483207</td>\n      <td>-1.905420</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>B6</td>\n      <td>BIRMINGHAM</td>\n      <td>Aston, Birchfield, Birmingham , Witton</td>\n      <td>Birmingham</td>\n      <td>(Witton, Holyoak Close, Brookvale Village, Bir...</td>\n      <td>(52.5122032, -1.8839156, 0.0)</td>\n      <td>52.512203</td>\n      <td>-1.883916</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "  Postcode district   Post town                                Coverage  \\\n1                B2  BIRMINGHAM      Birmingham City Centre, New Street   \n2                B3  BIRMINGHAM  Birmingham City Centre, Newhall Street   \n5                B6  BIRMINGHAM  Aston, Birchfield, Birmingham , Witton   \n\n  Local authority area                                           location  \\\n1           Birmingham  (New Street, Digbeth, Birmingham, West Midland...   \n2           Birmingham  (Newhall Street, Jewellery Quarter, Birmingham...   \n5           Birmingham  (Witton, Holyoak Close, Brookvale Village, Bir...   \n\n                           point   latitude  longitude  altitude  \n1  (52.4792602, -1.8999756, 0.0)  52.479260  -1.899976       0.0  \n2  (52.4832071, -1.9054204, 0.0)  52.483207  -1.905420       0.0  \n5  (52.5122032, -1.8839156, 0.0)  52.512203  -1.883916       0.0  "
                    },
                    "execution_count": 13,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "bir.head(3)"
        },
        {
            "cell_type": "code",
            "execution_count": 14,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "Postcode district       0\nPost town               0\nCoverage                0\nLocal authority area    0\nlocation                0\npoint                   0\nlatitude                0\nlongitude               0\naltitude                0\ndtype: int64"
                    },
                    "execution_count": 14,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "bir.isnull().sum()"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "Let's drop 'Post town', 'Local authority area', 'location', 'point' and 'altitude'."
        },
        {
            "cell_type": "code",
            "execution_count": 15,
            "metadata": {},
            "outputs": [
                {
                    "name": "stderr",
                    "output_type": "stream",
                    "text": "/opt/conda/envs/Python36/lib/python3.6/site-packages/pandas/core/frame.py:3940: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame\n\nSee the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n  errors=errors)\n/opt/conda/envs/Python36/lib/python3.6/site-packages/pandas/core/frame.py:4025: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame\n\nSee the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n  return super(DataFrame, self).rename(**kwargs)\n"
                },
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Neighborhood</th>\n      <th>latitude</th>\n      <th>longitude</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>Birmingham City Centre, New Street</td>\n      <td>52.479260</td>\n      <td>-1.899976</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Birmingham City Centre, Newhall Street</td>\n      <td>52.483207</td>\n      <td>-1.905420</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Aston, Birchfield, Birmingham , Witton</td>\n      <td>52.512203</td>\n      <td>-1.883916</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Nechells, Vauxhall</td>\n      <td>52.501356</td>\n      <td>-1.853372</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Bordesley Green, Bordesley</td>\n      <td>52.476970</td>\n      <td>-1.854852</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "                             Neighborhood   latitude  longitude\n1      Birmingham City Centre, New Street  52.479260  -1.899976\n2  Birmingham City Centre, Newhall Street  52.483207  -1.905420\n5  Aston, Birchfield, Birmingham , Witton  52.512203  -1.883916\n6                      Nechells, Vauxhall  52.501356  -1.853372\n8              Bordesley Green, Bordesley  52.476970  -1.854852"
                    },
                    "execution_count": 15,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "bir.drop(columns=['Postcode district','Post town','Local authority area','location','point','altitude'], inplace=True)\nbir.rename({'Coverage':'Neighborhood'},axis=1,inplace=True)\nbir.head()"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Prepare Manchester dataset"
        },
        {
            "cell_type": "code",
            "execution_count": 16,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Postcode district</th>\n      <th>Post town</th>\n      <th>Coverage</th>\n      <th>Local authority area</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>M1</td>\n      <td>MANCHESTER</td>\n      <td>Piccadilly, City Centre, Market Street</td>\n      <td>Manchester</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>M2</td>\n      <td>MANCHESTER</td>\n      <td>Deansgate, City Centre</td>\n      <td>Manchester</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>M3(Sectors 1, 2, 3, 4 and 9)</td>\n      <td>MANCHESTER</td>\n      <td>City Centre, Deansgate, Castlefield</td>\n      <td>Manchester</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>M3(Sectors 5, 6 and 7)</td>\n      <td>SALFORD</td>\n      <td>Blackfriars, Greengate, Trinity</td>\n      <td>Salford</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>M4</td>\n      <td>MANCHESTER</td>\n      <td>Ancoats, Northern Quarter, Strangeways</td>\n      <td>Manchester</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "              Postcode district   Post town  \\\n0                            M1  MANCHESTER   \n1                            M2  MANCHESTER   \n2  M3(Sectors 1, 2, 3, 4 and 9)  MANCHESTER   \n3        M3(Sectors 5, 6 and 7)     SALFORD   \n4                            M4  MANCHESTER   \n\n                                 Coverage Local authority area  \n0  Piccadilly, City Centre, Market Street           Manchester  \n1                  Deansgate, City Centre           Manchester  \n2     City Centre, Deansgate, Castlefield           Manchester  \n3         Blackfriars, Greengate, Trinity              Salford  \n4  Ancoats, Northern Quarter, Strangeways           Manchester  "
                    },
                    "execution_count": 16,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "list=[]\ndfs = pd.read_html('https://en.wikipedia.org/wiki/M_postcode_area',header=0)\nman = dfs[1]\nman.head()"
        },
        {
            "cell_type": "code",
            "execution_count": 17,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "MANCHESTER    45\nSALFORD        6\nSALE           1\nName: Post town, dtype: int64"
                    },
                    "execution_count": 17,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "man['Post town'].value_counts()"
        },
        {
            "cell_type": "code",
            "execution_count": 18,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "MANCHESTER    45\nName: Post town, dtype: int64"
                    },
                    "execution_count": 18,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "man = man[man['Post town'] == 'MANCHESTER']\nman['Post town'].value_counts()"
        },
        {
            "cell_type": "code",
            "execution_count": 19,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "Postcode district       0\nPost town               0\nCoverage                0\nLocal authority area    0\ndtype: int64"
                    },
                    "execution_count": 19,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "man.isnull().sum()"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "No nulls. Now add coordinates."
        },
        {
            "cell_type": "code",
            "execution_count": 20,
            "metadata": {},
            "outputs": [
                {
                    "name": "stderr",
                    "output_type": "stream",
                    "text": "/opt/conda/envs/Python36/lib/python3.6/site-packages/ipykernel/__main__.py:1: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n  if __name__ == '__main__':\n/opt/conda/envs/Python36/lib/python3.6/site-packages/ipykernel/__main__.py:2: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n  from ipykernel import kernelapp as app\n"
                }
            ],
            "source": "man['location'] = man['Coverage'].apply(geocode)\nman['point'] = man['location'].apply(lambda loc: tuple(loc.point) if loc else None)\nman[['latitude', 'longitude', 'altitude']] = pd.DataFrame(man['point'].tolist(), index=man.index)"
        },
        {
            "cell_type": "code",
            "execution_count": 21,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Coverage</th>\n      <th>latitude</th>\n      <th>longitude</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Piccadilly, City Centre, Market Street</td>\n      <td>53.482040</td>\n      <td>-2.239466</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Deansgate, City Centre</td>\n      <td>53.474096</td>\n      <td>-2.251063</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>City Centre, Deansgate, Castlefield</td>\n      <td>53.473210</td>\n      <td>-2.253761</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "                                 Coverage   latitude  longitude\n0  Piccadilly, City Centre, Market Street  53.482040  -2.239466\n1                  Deansgate, City Centre  53.474096  -2.251063\n2     City Centre, Deansgate, Castlefield  53.473210  -2.253761"
                    },
                    "execution_count": 21,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "man.drop(columns=['Postcode district','Post town','Local authority area','location','point','altitude'], inplace=True)\nman.head(3)"
        },
        {
            "cell_type": "code",
            "execution_count": 22,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "Coverage      0\nlatitude     20\nlongitude    20\ndtype: int64"
                    },
                    "execution_count": 22,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "man.isnull().sum()"
        },
        {
            "cell_type": "code",
            "execution_count": 23,
            "metadata": {},
            "outputs": [
                {
                    "name": "stderr",
                    "output_type": "stream",
                    "text": "/opt/conda/envs/Python36/lib/python3.6/site-packages/ipykernel/__main__.py:1: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame\n\nSee the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n  if __name__ == '__main__':\n"
                },
                {
                    "data": {
                        "text/plain": "Coverage     0\nlatitude     0\nlongitude    0\ndtype: int64"
                    },
                    "execution_count": 23,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "man.dropna(subset=['latitude','longitude'],inplace=True)\nman.isnull().sum()"
        },
        {
            "cell_type": "code",
            "execution_count": 24,
            "metadata": {},
            "outputs": [],
            "source": "man.rename({'Coverage':'Neighborhood'},axis=1,inplace=True)"
        },
        {
            "cell_type": "code",
            "execution_count": 25,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Neighborhood</th>\n      <th>latitude</th>\n      <th>longitude</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Piccadilly, City Centre, Market Street</td>\n      <td>53.482040</td>\n      <td>-2.239466</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Deansgate, City Centre</td>\n      <td>53.474096</td>\n      <td>-2.251063</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>City Centre, Deansgate, Castlefield</td>\n      <td>53.473210</td>\n      <td>-2.253761</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Crumpsall, Cheetham Hill</td>\n      <td>53.509024</td>\n      <td>-2.229556</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Harpurhey, Blackley</td>\n      <td>53.516950</td>\n      <td>-2.213172</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "                             Neighborhood   latitude  longitude\n0  Piccadilly, City Centre, Market Street  53.482040  -2.239466\n1                  Deansgate, City Centre  53.474096  -2.251063\n2     City Centre, Deansgate, Castlefield  53.473210  -2.253761\n8                Crumpsall, Cheetham Hill  53.509024  -2.229556\n9                     Harpurhey, Blackley  53.516950  -2.213172"
                    },
                    "execution_count": 25,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "man.head()"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Let's explore!\n\nFirst, let's explore each city. Mainly, what is trending in that city, or, what the top venues are in that city. This will help you undertand what kind of a city that is, and if it is for you. For example, if you are a foodie, and Manchester has many good restaurants, then you know where to go."
        },
        {
            "cell_type": "code",
            "execution_count": 26,
            "metadata": {},
            "outputs": [],
            "source": "def getNearbyVenues(names, latitudes, longitudes, radius=500):\n    \n    venues_list=[]\n    for name, lat, lng in zip(names, latitudes, longitudes):\n            \n        # create the API request URL\n        url = 'https://api.foursquare.com/v2/venues/explore?&client_id={}&client_secret={}&v={}&ll={},{}&radius={}&limit={}'.format(\n            CLIENT_ID, \n            CLIENT_SECRET, \n            VERSION, \n            lat, \n            lng, \n            radius, \n            LIMIT)\n            \n        # make the GET request\n        results = requests.get(url).json()[\"response\"]['groups'][0]['items']\n        \n        # return only relevant information for each nearby venue\n        venues_list.append([( \n            v['venue']['name'],\n            v['venue']['categories'][0]['name']) for v in results])\n\n    nearby_venues = pd.DataFrame([item for venue_list in venues_list for item in venue_list])\n    nearby_venues.columns = ['Venue','Venue Category']\n    \n    return(nearby_venues)"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Top 10 categories in Birmingham"
        },
        {
            "cell_type": "code",
            "execution_count": 27,
            "metadata": {},
            "outputs": [],
            "source": "bir_venues = getNearbyVenues(names=bir['Neighborhood'],\n                             latitudes=bir['latitude'],\n                             longitudes=bir['longitude']\n                            )"
        },
        {
            "cell_type": "code",
            "execution_count": 28,
            "metadata": {
                "scrolled": true
            },
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Venue</th>\n      <th>Venue Category</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Adams</td>\n      <td>Restaurant</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>200 Degrees Coffee</td>\n      <td>Coffee Shop</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Faculty</td>\n      <td>Coffee Shop</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Bodega Bar &amp; Cantina</td>\n      <td>South American Restaurant</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Purecraft Bar &amp; Kitchen</td>\n      <td>Beer Bar</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "                     Venue             Venue Category\n0                    Adams                 Restaurant\n1       200 Degrees Coffee                Coffee Shop\n2                  Faculty                Coffee Shop\n3     Bodega Bar & Cantina  South American Restaurant\n4  Purecraft Bar & Kitchen                   Beer Bar"
                    },
                    "execution_count": 28,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "bir_venues.head()"
        },
        {
            "cell_type": "code",
            "execution_count": 29,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "Number of places of interest: 230\n"
                }
            ],
            "source": "print(\"Number of places of interest:\", format(bir_venues.shape[0]))"
        },
        {
            "cell_type": "code",
            "execution_count": 30,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "Pub                     21\nIndian Restaurant       15\nCoffee Shop             15\nBar                     12\nSupermarket             10\nRestaurant               9\nTrain Station            7\nFast Food Restaurant     7\nItalian Restaurant       6\nName: Venue Category, dtype: int64"
                    },
                    "execution_count": 30,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "bir_top = bir_venues['Venue Category'].value_counts()[0:9]\nbir_top"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Top 10 categories in Manchester"
        },
        {
            "cell_type": "code",
            "execution_count": 31,
            "metadata": {},
            "outputs": [],
            "source": "man_venues = getNearbyVenues(names=man['Neighborhood'],\n                             latitudes=man['latitude'],\n                             longitudes=man['longitude']\n                            )"
        },
        {
            "cell_type": "code",
            "execution_count": 32,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Venue</th>\n      <th>Venue Category</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Northern Soul \u2022 Grilled Cheese</td>\n      <td>Sandwich Place</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Caf\u00e9 Beermoth</td>\n      <td>Bar</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Five Guys</td>\n      <td>Burger Joint</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Grand Pacific</td>\n      <td>Asian Restaurant</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Pieminister</td>\n      <td>Pie Shop</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "                            Venue    Venue Category\n0  Northern Soul \u2022 Grilled Cheese    Sandwich Place\n1                   Caf\u00e9 Beermoth               Bar\n2                       Five Guys      Burger Joint\n3                   Grand Pacific  Asian Restaurant\n4                     Pieminister          Pie Shop"
                    },
                    "execution_count": 32,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "man_venues.head()"
        },
        {
            "cell_type": "code",
            "execution_count": 33,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "Number of places of interest: 228\n"
                }
            ],
            "source": "print(\"Number of places of interest:\", format(man_venues.shape[0]))"
        },
        {
            "cell_type": "code",
            "execution_count": 34,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "Pub                  19\nCoffee Shop          11\nIndian Restaurant    10\nCaf\u00e9                  9\nBar                   9\nHotel                 8\nPark                  8\nRestaurant            7\nGastropub             6\nName: Venue Category, dtype: int64"
                    },
                    "execution_count": 34,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "man_top = man_venues['Venue Category'].value_counts()[0:9]\nman_top"
        },
        {
            "cell_type": "code",
            "execution_count": 35,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "(0, 0)"
                    },
                    "execution_count": 35,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "(bir_venues['Venue Category']==\"Zoo\").sum(), (man_venues['Venue Category']==\"Zoo\").sum() "
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "No zoo?! Dealbreaker. Haha I'm sure they have it."
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Observations:\n\n#### **Similarities**\n* Pubs\n* Indian Restaurants\n* Coffee Shops & Cafes\n* Bars\n* Restaurants\n* Supermarkets\n\n#### **Differences**\n* Birmingham has more Fast Food Restaurants, Italian Restaurants and Soccer Stadiums.\n* Manchester has more Parks, Hotels and Grocery Stores."
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Cluster the neighborhoods"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "I will create clusters of neighborhoods based on its Top 10 Venue Categories. For that, I need to\n\n- One hot encode the Venue Categories\n- Find the top 10 categories\n- Group by Neighborhoods"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Birmingham"
        },
        {
            "cell_type": "code",
            "execution_count": 36,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>American Restaurant</th>\n      <th>Aquarium</th>\n      <th>Art Gallery</th>\n      <th>Auto Garage</th>\n      <th>Auto Workshop</th>\n      <th>Bakery</th>\n      <th>Bar</th>\n      <th>Beer Bar</th>\n      <th>Bowling Alley</th>\n      <th>Caf\u00e9</th>\n      <th>...</th>\n      <th>Tapas Restaurant</th>\n      <th>Tea Room</th>\n      <th>Tennis Court</th>\n      <th>Tennis Stadium</th>\n      <th>Theater</th>\n      <th>Toy / Game Store</th>\n      <th>Trail</th>\n      <th>Train Station</th>\n      <th>Warehouse Store</th>\n      <th>Wine Shop</th>\n    </tr>\n    <tr>\n      <th>Neighborhood</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>NaN</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Birmingham City Centre, New Street</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Birmingham City Centre, Newhall Street</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>3 rows \u00d7 81 columns</p>\n</div>",
                        "text/plain": "                                        American Restaurant  Aquarium  \\\nNeighborhood                                                            \nNaN                                                       0         0   \nBirmingham City Centre, New Street                        0         0   \nBirmingham City Centre, Newhall Street                    0         0   \n\n                                        Art Gallery  Auto Garage  \\\nNeighborhood                                                       \nNaN                                               0            0   \nBirmingham City Centre, New Street                0            0   \nBirmingham City Centre, Newhall Street            0            0   \n\n                                        Auto Workshop  Bakery  Bar  Beer Bar  \\\nNeighborhood                                                                   \nNaN                                                 0       0    0         0   \nBirmingham City Centre, New Street                  0       0    0         0   \nBirmingham City Centre, Newhall Street              0       0    0         0   \n\n                                        Bowling Alley  Caf\u00e9  ...  \\\nNeighborhood                                                 ...   \nNaN                                                 0     0  ...   \nBirmingham City Centre, New Street                  0     0  ...   \nBirmingham City Centre, Newhall Street              0     0  ...   \n\n                                        Tapas Restaurant  Tea Room  \\\nNeighborhood                                                         \nNaN                                                    0         0   \nBirmingham City Centre, New Street                     0         0   \nBirmingham City Centre, Newhall Street                 0         0   \n\n                                        Tennis Court  Tennis Stadium  Theater  \\\nNeighborhood                                                                    \nNaN                                                0               0        0   \nBirmingham City Centre, New Street                 0               0        0   \nBirmingham City Centre, Newhall Street             0               0        0   \n\n                                        Toy / Game Store  Trail  \\\nNeighborhood                                                      \nNaN                                                    0      0   \nBirmingham City Centre, New Street                     0      0   \nBirmingham City Centre, Newhall Street                 0      0   \n\n                                        Train Station  Warehouse Store  \\\nNeighborhood                                                             \nNaN                                                 0                0   \nBirmingham City Centre, New Street                  0                0   \nBirmingham City Centre, Newhall Street              0                0   \n\n                                        Wine Shop  \nNeighborhood                                       \nNaN                                             0  \nBirmingham City Centre, New Street              0  \nBirmingham City Centre, Newhall Street          0  \n\n[3 rows x 81 columns]"
                    },
                    "execution_count": 36,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "bir_onehot = pd.get_dummies(bir_venues[['Venue Category']], prefix=\"\", prefix_sep=\"\")\n\n# add neighborhood column back to dataframe\nbir_onehot['Neighborhood'] = bir['Neighborhood'] \n\nbir_onehot.set_index(\"Neighborhood\",inplace=True)\n\nbir_onehot.head(3)"
        },
        {
            "cell_type": "code",
            "execution_count": 37,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Neighborhood</th>\n      <th>1st Most Common Venue</th>\n      <th>2nd Most Common Venue</th>\n      <th>3rd Most Common Venue</th>\n      <th>4th Most Common Venue</th>\n      <th>5th Most Common Venue</th>\n      <th>6th Most Common Venue</th>\n      <th>7th Most Common Venue</th>\n      <th>8th Most Common Venue</th>\n      <th>9th Most Common Venue</th>\n      <th>10th Most Common Venue</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Acocks Green</td>\n      <td>History Museum</td>\n      <td>Wine Shop</td>\n      <td>Gaming Cafe</td>\n      <td>English Restaurant</td>\n      <td>Fast Food Restaurant</td>\n      <td>Fish &amp; Chips Shop</td>\n      <td>Food &amp; Drink Shop</td>\n      <td>Food Court</td>\n      <td>Fried Chicken Joint</td>\n      <td>Furniture / Home Store</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Alvechurch</td>\n      <td>Pizza Place</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n      <td>Fish &amp; Chips Shop</td>\n      <td>Food &amp; Drink Shop</td>\n      <td>Food Court</td>\n      <td>Fried Chicken Joint</td>\n      <td>Furniture / Home Store</td>\n      <td>Gaming Cafe</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Aston, Birchfield, Birmingham , Witton</td>\n      <td>Bar</td>\n      <td>Wine Shop</td>\n      <td>Garden</td>\n      <td>Fast Food Restaurant</td>\n      <td>Fish &amp; Chips Shop</td>\n      <td>Food &amp; Drink Shop</td>\n      <td>Food Court</td>\n      <td>Fried Chicken Joint</td>\n      <td>Furniture / Home Store</td>\n      <td>Gaming Cafe</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Birmingham City Centre, New Street</td>\n      <td>Coffee Shop</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n      <td>Fish &amp; Chips Shop</td>\n      <td>Food &amp; Drink Shop</td>\n      <td>Food Court</td>\n      <td>Fried Chicken Joint</td>\n      <td>Furniture / Home Store</td>\n      <td>Gaming Cafe</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Birmingham City Centre, Newhall Street</td>\n      <td>Coffee Shop</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n      <td>Fish &amp; Chips Shop</td>\n      <td>Food &amp; Drink Shop</td>\n      <td>Food Court</td>\n      <td>Fried Chicken Joint</td>\n      <td>Furniture / Home Store</td>\n      <td>Gaming Cafe</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "                             Neighborhood 1st Most Common Venue  \\\n0                            Acocks Green        History Museum   \n1                              Alvechurch           Pizza Place   \n2  Aston, Birchfield, Birmingham , Witton                   Bar   \n3      Birmingham City Centre, New Street           Coffee Shop   \n4  Birmingham City Centre, Newhall Street           Coffee Shop   \n\n  2nd Most Common Venue 3rd Most Common Venue 4th Most Common Venue  \\\n0             Wine Shop           Gaming Cafe    English Restaurant   \n1             Wine Shop      Department Store  Fast Food Restaurant   \n2             Wine Shop                Garden  Fast Food Restaurant   \n3             Wine Shop      Department Store  Fast Food Restaurant   \n4             Wine Shop      Department Store  Fast Food Restaurant   \n\n  5th Most Common Venue 6th Most Common Venue 7th Most Common Venue  \\\n0  Fast Food Restaurant     Fish & Chips Shop     Food & Drink Shop   \n1     Fish & Chips Shop     Food & Drink Shop            Food Court   \n2     Fish & Chips Shop     Food & Drink Shop            Food Court   \n3     Fish & Chips Shop     Food & Drink Shop            Food Court   \n4     Fish & Chips Shop     Food & Drink Shop            Food Court   \n\n  8th Most Common Venue   9th Most Common Venue  10th Most Common Venue  \n0            Food Court     Fried Chicken Joint  Furniture / Home Store  \n1   Fried Chicken Joint  Furniture / Home Store             Gaming Cafe  \n2   Fried Chicken Joint  Furniture / Home Store             Gaming Cafe  \n3   Fried Chicken Joint  Furniture / Home Store             Gaming Cafe  \n4   Fried Chicken Joint  Furniture / Home Store             Gaming Cafe  "
                    },
                    "execution_count": 37,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "# Group by neighborhood\nbir_grouped = bir_onehot.groupby('Neighborhood').mean().reset_index()\n\ndef return_most_common_venues(row, num_top_venues):\n    row_categories = row.iloc[1:]\n    row_categories_sorted = row_categories.sort_values(ascending=False)\n    \n    return row_categories_sorted.index.values[0:num_top_venues]\n\nnum_top_venues = 10\n\nindicators = ['st', 'nd', 'rd']\n\n# create columns according to number of top venues\ncolumns = ['Neighborhood']\nfor ind in np.arange(num_top_venues):\n    try:\n        columns.append('{}{} Most Common Venue'.format(ind+1, indicators[ind]))\n    except:\n        columns.append('{}th Most Common Venue'.format(ind+1))\n\n# create a new dataframe\nneighborhoods_venues_sorted = pd.DataFrame(columns=columns)\nneighborhoods_venues_sorted['Neighborhood'] = bir_grouped['Neighborhood']\n\nfor ind in np.arange(bir_grouped.shape[0]):\n    neighborhoods_venues_sorted.iloc[ind, 1:] = return_most_common_venues(bir_grouped.iloc[ind, :], num_top_venues)\n\nneighborhoods_venues_sorted.head()"
        },
        {
            "cell_type": "code",
            "execution_count": 38,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "array([0, 0, 0, 1, 1, 0, 1, 0, 2, 0, 0, 0, 2, 0, 0, 2, 0, 0, 0, 0, 0, 0,\n       0, 1, 1, 0, 0, 2, 0, 0, 0, 0], dtype=int32)"
                    },
                    "execution_count": 38,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "kclusters = 3\n\nbir_grouped_clustering = bir_grouped.drop('Neighborhood', 1)\n\nkmeans = KMeans(n_clusters=kclusters, random_state=0).fit(bir_grouped_clustering)\n\nkmeans.labels_"
        },
        {
            "cell_type": "code",
            "execution_count": 39,
            "metadata": {
                "scrolled": true
            },
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Neighborhood</th>\n      <th>latitude</th>\n      <th>longitude</th>\n      <th>Cluster Labels</th>\n      <th>1st Most Common Venue</th>\n      <th>2nd Most Common Venue</th>\n      <th>3rd Most Common Venue</th>\n      <th>4th Most Common Venue</th>\n      <th>5th Most Common Venue</th>\n      <th>6th Most Common Venue</th>\n      <th>7th Most Common Venue</th>\n      <th>8th Most Common Venue</th>\n      <th>9th Most Common Venue</th>\n      <th>10th Most Common Venue</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>Birmingham City Centre, New Street</td>\n      <td>52.479260</td>\n      <td>-1.899976</td>\n      <td>1</td>\n      <td>Coffee Shop</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n      <td>Fish &amp; Chips Shop</td>\n      <td>Food &amp; Drink Shop</td>\n      <td>Food Court</td>\n      <td>Fried Chicken Joint</td>\n      <td>Furniture / Home Store</td>\n      <td>Gaming Cafe</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Birmingham City Centre, Newhall Street</td>\n      <td>52.483207</td>\n      <td>-1.905420</td>\n      <td>1</td>\n      <td>Coffee Shop</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n      <td>Fish &amp; Chips Shop</td>\n      <td>Food &amp; Drink Shop</td>\n      <td>Food Court</td>\n      <td>Fried Chicken Joint</td>\n      <td>Furniture / Home Store</td>\n      <td>Gaming Cafe</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Aston, Birchfield, Birmingham , Witton</td>\n      <td>52.512203</td>\n      <td>-1.883916</td>\n      <td>0</td>\n      <td>Bar</td>\n      <td>Wine Shop</td>\n      <td>Garden</td>\n      <td>Fast Food Restaurant</td>\n      <td>Fish &amp; Chips Shop</td>\n      <td>Food &amp; Drink Shop</td>\n      <td>Food Court</td>\n      <td>Fried Chicken Joint</td>\n      <td>Furniture / Home Store</td>\n      <td>Gaming Cafe</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Nechells, Vauxhall</td>\n      <td>52.501356</td>\n      <td>-1.853372</td>\n      <td>1</td>\n      <td>Coffee Shop</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n      <td>Fish &amp; Chips Shop</td>\n      <td>Food &amp; Drink Shop</td>\n      <td>Food Court</td>\n      <td>Fried Chicken Joint</td>\n      <td>Furniture / Home Store</td>\n      <td>Gaming Cafe</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Bordesley Green, Bordesley</td>\n      <td>52.476970</td>\n      <td>-1.854852</td>\n      <td>0</td>\n      <td>Gaming Cafe</td>\n      <td>Wine Shop</td>\n      <td>Indian Restaurant</td>\n      <td>English Restaurant</td>\n      <td>Fast Food Restaurant</td>\n      <td>Fish &amp; Chips Shop</td>\n      <td>Food &amp; Drink Shop</td>\n      <td>Food Court</td>\n      <td>Fried Chicken Joint</td>\n      <td>Furniture / Home Store</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "                             Neighborhood   latitude  longitude  \\\n1      Birmingham City Centre, New Street  52.479260  -1.899976   \n2  Birmingham City Centre, Newhall Street  52.483207  -1.905420   \n5  Aston, Birchfield, Birmingham , Witton  52.512203  -1.883916   \n6                      Nechells, Vauxhall  52.501356  -1.853372   \n8              Bordesley Green, Bordesley  52.476970  -1.854852   \n\n   Cluster Labels 1st Most Common Venue 2nd Most Common Venue  \\\n1               1           Coffee Shop             Wine Shop   \n2               1           Coffee Shop             Wine Shop   \n5               0                   Bar             Wine Shop   \n6               1           Coffee Shop             Wine Shop   \n8               0           Gaming Cafe             Wine Shop   \n\n  3rd Most Common Venue 4th Most Common Venue 5th Most Common Venue  \\\n1      Department Store  Fast Food Restaurant     Fish & Chips Shop   \n2      Department Store  Fast Food Restaurant     Fish & Chips Shop   \n5                Garden  Fast Food Restaurant     Fish & Chips Shop   \n6      Department Store  Fast Food Restaurant     Fish & Chips Shop   \n8     Indian Restaurant    English Restaurant  Fast Food Restaurant   \n\n  6th Most Common Venue 7th Most Common Venue 8th Most Common Venue  \\\n1     Food & Drink Shop            Food Court   Fried Chicken Joint   \n2     Food & Drink Shop            Food Court   Fried Chicken Joint   \n5     Food & Drink Shop            Food Court   Fried Chicken Joint   \n6     Food & Drink Shop            Food Court   Fried Chicken Joint   \n8     Fish & Chips Shop     Food & Drink Shop            Food Court   \n\n    9th Most Common Venue  10th Most Common Venue  \n1  Furniture / Home Store             Gaming Cafe  \n2  Furniture / Home Store             Gaming Cafe  \n5  Furniture / Home Store             Gaming Cafe  \n6  Furniture / Home Store             Gaming Cafe  \n8     Fried Chicken Joint  Furniture / Home Store  "
                    },
                    "execution_count": 39,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "# New dataframe that includes the cluster as well as the top 10 venues for each neighborhood\n\n# Drop old 'Cluster Labels' column if it exists\nif \"Cluster Labels\" in neighborhoods_venues_sorted.columns:\n    neighborhoods_venues_sorted = neighborhoods_venues_sorted.drop('Cluster Labels', axis=1)\n\n# add clustering labels\nneighborhoods_venues_sorted.insert(0, 'Cluster Labels', kmeans.labels_)\n\nbir_merged = bir\n\n# merge toronto_grouped with toronto_data to add latitude/longitude for each neighborhood\nbir_merged = bir_merged.join(neighborhoods_venues_sorted.set_index('Neighborhood'), on='Neighborhood')\n\nbir_merged.head()"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "After running the below visualization, I noticed two circle spots outside Birmingham. They must be a mistake. Let's drop them."
        },
        {
            "cell_type": "code",
            "execution_count": 40,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Neighborhood</th>\n      <th>latitude</th>\n      <th>longitude</th>\n      <th>Cluster Labels</th>\n      <th>1st Most Common Venue</th>\n      <th>2nd Most Common Venue</th>\n      <th>3rd Most Common Venue</th>\n      <th>4th Most Common Venue</th>\n      <th>5th Most Common Venue</th>\n      <th>6th Most Common Venue</th>\n      <th>7th Most Common Venue</th>\n      <th>8th Most Common Venue</th>\n      <th>9th Most Common Venue</th>\n      <th>10th Most Common Venue</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Birmingham City Centre, New Street</td>\n      <td>52.479260</td>\n      <td>-1.899976</td>\n      <td>1</td>\n      <td>Coffee Shop</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n      <td>Fish &amp; Chips Shop</td>\n      <td>Food &amp; Drink Shop</td>\n      <td>Food Court</td>\n      <td>Fried Chicken Joint</td>\n      <td>Furniture / Home Store</td>\n      <td>Gaming Cafe</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Birmingham City Centre, Newhall Street</td>\n      <td>52.483207</td>\n      <td>-1.905420</td>\n      <td>1</td>\n      <td>Coffee Shop</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n      <td>Fish &amp; Chips Shop</td>\n      <td>Food &amp; Drink Shop</td>\n      <td>Food Court</td>\n      <td>Fried Chicken Joint</td>\n      <td>Furniture / Home Store</td>\n      <td>Gaming Cafe</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "                             Neighborhood   latitude  longitude  \\\n0      Birmingham City Centre, New Street  52.479260  -1.899976   \n1  Birmingham City Centre, Newhall Street  52.483207  -1.905420   \n\n   Cluster Labels 1st Most Common Venue 2nd Most Common Venue  \\\n0               1           Coffee Shop             Wine Shop   \n1               1           Coffee Shop             Wine Shop   \n\n  3rd Most Common Venue 4th Most Common Venue 5th Most Common Venue  \\\n0      Department Store  Fast Food Restaurant     Fish & Chips Shop   \n1      Department Store  Fast Food Restaurant     Fish & Chips Shop   \n\n  6th Most Common Venue 7th Most Common Venue 8th Most Common Venue  \\\n0     Food & Drink Shop            Food Court   Fried Chicken Joint   \n1     Food & Drink Shop            Food Court   Fried Chicken Joint   \n\n    9th Most Common Venue 10th Most Common Venue  \n0  Furniture / Home Store            Gaming Cafe  \n1  Furniture / Home Store            Gaming Cafe  "
                    },
                    "execution_count": 40,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "bir_merged.set_index('Neighborhood',inplace=True)\nbir_merged.drop(['Handsworth','Yardley'],inplace=True)\nbir_merged.reset_index(inplace=True)\nbir_merged.head(2)"
        },
        {
            "cell_type": "code",
            "execution_count": 41,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div style=\"width:100%;\"><div style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"><span style=\"color:#565656\">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe src=\"about:blank\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" data-html=PCFET0NUWVBFIGh0bWw+CjxoZWFkPiAgICAKICAgIDxtZXRhIGh0dHAtZXF1aXY9ImNvbnRlbnQtdHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PVVURi04IiAvPgogICAgPHNjcmlwdD5MX1BSRUZFUl9DQU5WQVMgPSBmYWxzZTsgTF9OT19UT1VDSCA9IGZhbHNlOyBMX0RJU0FCTEVfM0QgPSBmYWxzZTs8L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2FqYXguZ29vZ2xlYXBpcy5jb20vYWpheC9saWJzL2pxdWVyeS8xLjExLjEvanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvanMvYm9vdHN0cmFwLm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuanMiPjwvc2NyaXB0PgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmNzcyIvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9jc3MvYm9vdHN0cmFwLm1pbi5jc3MiLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvY3NzL2Jvb3RzdHJhcC10aGVtZS5taW4uY3NzIi8+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuNi4zL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyIvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9MZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy8yLjAuMi9sZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy5jc3MiLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9yYXdnaXQuY29tL3B5dGhvbi12aXN1YWxpemF0aW9uL2ZvbGl1bS9tYXN0ZXIvZm9saXVtL3RlbXBsYXRlcy9sZWFmbGV0LmF3ZXNvbWUucm90YXRlLmNzcyIvPgogICAgPHN0eWxlPmh0bWwsIGJvZHkge3dpZHRoOiAxMDAlO2hlaWdodDogMTAwJTttYXJnaW46IDA7cGFkZGluZzogMDt9PC9zdHlsZT4KICAgIDxzdHlsZT4jbWFwIHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtib3R0b206MDtyaWdodDowO2xlZnQ6MDt9PC9zdHlsZT4KICAgIAogICAgICAgICAgICA8c3R5bGU+ICNtYXBfZGUxZGEzNDExN2I4NDAwNjkyNjI5ZDAzN2IyMWI1MzYgewogICAgICAgICAgICAgICAgcG9zaXRpb24gOiByZWxhdGl2ZTsKICAgICAgICAgICAgICAgIHdpZHRoIDogMTAwLjAlOwogICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAuMCU7CiAgICAgICAgICAgICAgICBsZWZ0OiAwLjAlOwogICAgICAgICAgICAgICAgdG9wOiAwLjAlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICA8L3N0eWxlPgogICAgICAgIAo8L2hlYWQ+Cjxib2R5PiAgICAKICAgIAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb2xpdW0tbWFwIiBpZD0ibWFwX2RlMWRhMzQxMTdiODQwMDY5MjYyOWQwMzdiMjFiNTM2IiA+PC9kaXY+CiAgICAgICAgCjwvYm9keT4KPHNjcmlwdD4gICAgCiAgICAKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGJvdW5kcyA9IG51bGw7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcF9kZTFkYTM0MTE3Yjg0MDA2OTI2MjlkMDM3YjIxYjUzNiA9IEwubWFwKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21hcF9kZTFkYTM0MTE3Yjg0MDA2OTI2MjlkMDM3YjIxYjUzNicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2VudGVyOiBbNTIuNDg2MiwtMS44OTA0XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpvb206IDEwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4Qm91bmRzOiBib3VuZHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXllcnM6IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ybGRDb3B5SnVtcDogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcnM6IEwuQ1JTLkVQU0czODU3CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgdGlsZV9sYXllcl84MzFiZDExN2U1OTY0MjI1YTAxYWNjYTA3NTI0YTRlOSA9IEwudGlsZUxheWVyKAogICAgICAgICAgICAgICAgJ2h0dHBzOi8ve3N9LnRpbGUub3BlbnN0cmVldG1hcC5vcmcve3p9L3t4fS97eX0ucG5nJywKICAgICAgICAgICAgICAgIHsKICAiYXR0cmlidXRpb24iOiBudWxsLAogICJkZXRlY3RSZXRpbmEiOiBmYWxzZSwKICAibWF4Wm9vbSI6IDE4LAogICJtaW5ab29tIjogMSwKICAibm9XcmFwIjogZmFsc2UsCiAgInN1YmRvbWFpbnMiOiAiYWJjIgp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9kZTFkYTM0MTE3Yjg0MDA2OTI2MjlkMDM3YjIxYjUzNik7CiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNmM3NGM4ZDYyYTVmNGY4NDk4ODU1ODZhNDlmZWQ3OWUgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi40NzkyNjAyLC0xLjg5OTk3NTZdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwMDBmZiIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MDAwZmYiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfZGUxZGEzNDExN2I4NDAwNjkyNjI5ZDAzN2IyMWI1MzYpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfMWY5OWMwZjRhNGI5NDI0YTg0NWQ0ZGJmYjczMThlYjkgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfN2EyYTdjOTZjM2FlNGFlNmIyMjA3ZDI4NGI5OWY4MDcgPSAkKCc8ZGl2IGlkPSJodG1sXzdhMmE3Yzk2YzNhZTRhZTZiMjIwN2QyODRiOTlmODA3IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5CaXJtaW5naGFtIENpdHkgQ2VudHJlLCBOZXcgU3RyZWV0IENsdXN0ZXIgMTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfMWY5OWMwZjRhNGI5NDI0YTg0NWQ0ZGJmYjczMThlYjkuc2V0Q29udGVudChodG1sXzdhMmE3Yzk2YzNhZTRhZTZiMjIwN2QyODRiOTlmODA3KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzZjNzRjOGQ2MmE1ZjRmODQ5ODg1NTg2YTQ5ZmVkNzllLmJpbmRQb3B1cChwb3B1cF8xZjk5YzBmNGE0Yjk0MjRhODQ1ZDRkYmZiNzMxOGViOSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl83MmNlMmJhZWQ2NzQ0NDVmYjNmZTk0ODk0ODJjNTAxMSA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzUyLjQ4MzIwNzEsLTEuOTA1NDIwNF0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjODAwMGZmIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzgwMDBmZiIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9kZTFkYTM0MTE3Yjg0MDA2OTI2MjlkMDM3YjIxYjUzNik7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF85YmEzMmNlNGVmODI0ZjYyYjA5MDI1M2M5NDhjNmUzNiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF80Nzg2M2UzNWE0NWU0OTU1YjVlNGI1NTI4ZjFjZmYxMyA9ICQoJzxkaXYgaWQ9Imh0bWxfNDc4NjNlMzVhNDVlNDk1NWI1ZTRiNTUyOGYxY2ZmMTMiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkJpcm1pbmdoYW0gQ2l0eSBDZW50cmUsIE5ld2hhbGwgU3RyZWV0IENsdXN0ZXIgMTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfOWJhMzJjZTRlZjgyNGY2MmIwOTAyNTNjOTQ4YzZlMzYuc2V0Q29udGVudChodG1sXzQ3ODYzZTM1YTQ1ZTQ5NTViNWU0YjU1MjhmMWNmZjEzKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzcyY2UyYmFlZDY3NDQ0NWZiM2ZlOTQ4OTQ4MmM1MDExLmJpbmRQb3B1cChwb3B1cF85YmEzMmNlNGVmODI0ZjYyYjA5MDI1M2M5NDhjNmUzNik7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl83ZTI2MTliNDQxMjY0NTRiYTE5NjA5NDc0YTA5YzRkYSA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzUyLjUxMjIwMzIsLTEuODgzOTE1Nl0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjZmYwMDAwIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiI2ZmMDAwMCIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9kZTFkYTM0MTE3Yjg0MDA2OTI2MjlkMDM3YjIxYjUzNik7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8yZDhjMTJhZDBhMmM0YWQzYTJhNjRmMTRlZDcwYWY0MSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF80N2I3MDk4MjY0NTk0MzhkOGYyOGM1MWYwMzZhMDE4OCA9ICQoJzxkaXYgaWQ9Imh0bWxfNDdiNzA5ODI2NDU5NDM4ZDhmMjhjNTFmMDM2YTAxODgiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkFzdG9uLCBCaXJjaGZpZWxkLCBCaXJtaW5naGFtICwgV2l0dG9uIENsdXN0ZXIgMDwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfMmQ4YzEyYWQwYTJjNGFkM2EyYTY0ZjE0ZWQ3MGFmNDEuc2V0Q29udGVudChodG1sXzQ3YjcwOTgyNjQ1OTQzOGQ4ZjI4YzUxZjAzNmEwMTg4KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzdlMjYxOWI0NDEyNjQ1NGJhMTk2MDk0NzRhMDljNGRhLmJpbmRQb3B1cChwb3B1cF8yZDhjMTJhZDBhMmM0YWQzYTJhNjRmMTRlZDcwYWY0MSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl84MDlkMTc1M2UxMmU0YjM0ODhjYjE4YjkzOTQzZjdkNyA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzUyLjUwMTM1NjQ1LC0xLjg1MzM3MTk3NzgxMjIwNzddLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwMDBmZiIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MDAwZmYiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfZGUxZGEzNDExN2I4NDAwNjkyNjI5ZDAzN2IyMWI1MzYpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfMjVmMzRjZTljNTQyNGNkYWIzYTY2NmU2NjU1NjEyMmEgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfYmVkM2QzYzNkZDc1NDQ5ODgxNTA5OWNhYTA4ODMzYWMgPSAkKCc8ZGl2IGlkPSJodG1sX2JlZDNkM2MzZGQ3NTQ0OTg4MTUwOTljYWEwODgzM2FjIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5OZWNoZWxscywgVmF1eGhhbGwgQ2x1c3RlciAxPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8yNWYzNGNlOWM1NDI0Y2RhYjNhNjY2ZTY2NTU2MTIyYS5zZXRDb250ZW50KGh0bWxfYmVkM2QzYzNkZDc1NDQ5ODgxNTA5OWNhYTA4ODMzYWMpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfODA5ZDE3NTNlMTJlNGIzNDg4Y2IxOGI5Mzk0M2Y3ZDcuYmluZFBvcHVwKHBvcHVwXzI1ZjM0Y2U5YzU0MjRjZGFiM2E2NjZlNjY1NTYxMjJhKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2Y5MTg4ODc5MzQ3MTQ4YTI5ZDdkZWZiMjE4MWI3YTdhID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTIuNDc2OTY5NiwtMS44NTQ4NTE5XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiNmZjAwMDAiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjZmYwMDAwIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2RlMWRhMzQxMTdiODQwMDY5MjYyOWQwMzdiMjFiNTM2KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2IwNWFmMDQxYTk4MTQ3ODY5OWQxNjMwZjk5MjlkMDgxID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2JiMDBmNGQ4OTgwZDRhZGY5YTAwZTYwNDg5NmY4NGJmID0gJCgnPGRpdiBpZD0iaHRtbF9iYjAwZjRkODk4MGQ0YWRmOWEwMGU2MDQ4OTZmODRiZiIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+Qm9yZGVzbGV5IEdyZWVuLCBCb3JkZXNsZXkgQ2x1c3RlciAwPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9iMDVhZjA0MWE5ODE0Nzg2OTlkMTYzMGY5OTI5ZDA4MS5zZXRDb250ZW50KGh0bWxfYmIwMGY0ZDg5ODBkNGFkZjlhMDBlNjA0ODk2Zjg0YmYpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfZjkxODg4NzkzNDcxNDhhMjlkN2RlZmIyMTgxYjdhN2EuYmluZFBvcHVwKHBvcHVwX2IwNWFmMDQxYTk4MTQ3ODY5OWQxNjMwZjk5MjlkMDgxKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2IwODY2MDliODVlMDRiMzE4ZTlhZTAxNDJlODgwOWM3ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTIuNDYzNjgwOSwtMS44NTkzMTk0XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiNmZjAwMDAiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjZmYwMDAwIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2RlMWRhMzQxMTdiODQwMDY5MjYyOWQwMzdiMjFiNTM2KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzFkZGJmNTczMWQ4MDRlNzE5YjYzZGE5ZjVkMjA2NWQ3ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2QzNmMwYmQ0OTQwZDQ0YTZiNzQ5ODA3MWE0MTQ0YzhhID0gJCgnPGRpdiBpZD0iaHRtbF9kMzZjMGJkNDk0MGQ0NGE2Yjc0OTgwNzFhNDE0NGM4YSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+U21hbGwgSGVhdGggQ2x1c3RlciAwPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8xZGRiZjU3MzFkODA0ZTcxOWI2M2RhOWY1ZDIwNjVkNy5zZXRDb250ZW50KGh0bWxfZDM2YzBiZDQ5NDBkNDRhNmI3NDk4MDcxYTQxNDRjOGEpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfYjA4NjYwOWI4NWUwNGIzMThlOWFlMDE0MmU4ODA5YzcuYmluZFBvcHVwKHBvcHVwXzFkZGJmNTczMWQ4MDRlNzE5YjYzZGE5ZjVkMjA2NWQ3KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2I3MGM0NWQ4YThkMjRlNDZhOTBjZjQyZjI0OGJmMWRjID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTIuNDI0MzA2OTAwMDAwMDA1LC0xLjg3NTQ0NDc1MjI2MzQxMV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjZmYwMDAwIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiI2ZmMDAwMCIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9kZTFkYTM0MTE3Yjg0MDA2OTI2MjlkMDM3YjIxYjUzNik7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF85YTVhNDcyM2VlNGQ0NTc5OTQyMjdmZTY5YWJjOTQxNyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9mOTVkYjNkZjE1ZTA0MDQ4YWI3ZTEwMzgzZDM2N2I4OSA9ICQoJzxkaXYgaWQ9Imh0bWxfZjk1ZGIzZGYxNWUwNDA0OGFiN2UxMDM4M2QzNjdiODkiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPk1vc2VsZXksIEJpbGxlc2xleSBDbHVzdGVyIDA8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzlhNWE0NzIzZWU0ZDQ1Nzk5NDIyN2ZlNjlhYmM5NDE3LnNldENvbnRlbnQoaHRtbF9mOTVkYjNkZjE1ZTA0MDQ4YWI3ZTEwMzgzZDM2N2I4OSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9iNzBjNDVkOGE4ZDI0ZTQ2YTkwY2Y0MmYyNDhiZjFkYy5iaW5kUG9wdXAocG9wdXBfOWE1YTQ3MjNlZTRkNDU3OTk0MjI3ZmU2OWFiYzk0MTcpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfMGQzYjExMmNlZWFkNGJlY2E1NzJmOWI1OThlNmQ3MTcgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi40MTg0NDk1NTAwMDAwMDUsLTEuODc3MzAyMzcxNjI1MDk0XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiNmZjAwMDAiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjZmYwMDAwIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2RlMWRhMzQxMTdiODQwMDY5MjYyOWQwMzdiMjFiNTM2KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzk0NWM1MmIxYWI5ZjQ1NTJiOGJhZmRlNjljMWUwZDFjID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzE0Y2MxZTYxNzk0NjQ3OGQ5NzY2NmRjNzQ0Y2Q2OWUxID0gJCgnPGRpdiBpZD0iaHRtbF8xNGNjMWU2MTc5NDY0NzhkOTc2NjZkYzc0NGNkNjllMSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+S2luZ3MgSGVhdGgsIFlhcmRsZXkgV29vZCwgRHJ1aWRzIEhlYXRoLCBIaWdodGVyJiMzOTtzIEhlYXRoLCBXYXJzdG9jayBDbHVzdGVyIDA8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzk0NWM1MmIxYWI5ZjQ1NTJiOGJhZmRlNjljMWUwZDFjLnNldENvbnRlbnQoaHRtbF8xNGNjMWU2MTc5NDY0NzhkOTc2NjZkYzc0NGNkNjllMSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8wZDNiMTEyY2VlYWQ0YmVjYTU3MmY5YjU5OGU2ZDcxNy5iaW5kUG9wdXAocG9wdXBfOTQ1YzUyYjFhYjlmNDU1MmI4YmFmZGU2OWMxZTBkMWMpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfMzliYjg2ZDBiMGNkNDczZGIzZjk5ZmQwYjA5ZjM3NDYgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi40NjAzMjYxLC0xLjkxNzkwOThdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiI2ZmMDAwMCIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiNmZjAwMDAiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfZGUxZGEzNDExN2I4NDAwNjkyNjI5ZDAzN2IyMWI1MzYpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZjAwMGIwZThiNzIwNDExODgwZGFkNGZhZWJiNzQwMTYgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfYzFlYzIyM2JlNDQxNDI0OThiMjBjNDk4MmMwNWYzNGIgPSAkKCc8ZGl2IGlkPSJodG1sX2MxZWMyMjNiZTQ0MTQyNDk4YjIwYzQ5ODJjMDVmMzRiIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5FZGdiYXN0b24sIENsdXN0ZXIgMDwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZjAwMGIwZThiNzIwNDExODgwZGFkNGZhZWJiNzQwMTYuc2V0Q29udGVudChodG1sX2MxZWMyMjNiZTQ0MTQyNDk4YjIwYzQ5ODJjMDVmMzRiKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzM5YmI4NmQwYjBjZDQ3M2RiM2Y5OWZkMGIwOWYzNzQ2LmJpbmRQb3B1cChwb3B1cF9mMDAwYjBlOGI3MjA0MTE4ODBkYWQ0ZmFlYmI3NDAxNik7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl9kNDU2NTNhZTRlOWY0YjMyODY5NDJmOTE1YjUyZjEyNyA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzUyLjQ4MDU5NTQsLTEuOTE4NTA2XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiNmZjAwMDAiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjZmYwMDAwIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2RlMWRhMzQxMTdiODQwMDY5MjYyOWQwMzdiMjFiNTM2KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2RiMzY5ZjVhYTE2YTQ0NDJhZTMxYmJmYmY2NWJmNDk3ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2Y0YWUwNmUyYTIyYTRlZjA5YTZhMGMwMDM5Yzk4YWJiID0gJCgnPGRpdiBpZD0iaHRtbF9mNGFlMDZlMmEyMmE0ZWYwOWE2YTBjMDAzOWM5OGFiYiIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+TGFkeXdvb2QgQ2x1c3RlciAwPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9kYjM2OWY1YWExNmE0NDQyYWUzMWJiZmJmNjViZjQ5Ny5zZXRDb250ZW50KGh0bWxfZjRhZTA2ZTJhMjJhNGVmMDlhNmEwYzAwMzljOThhYmIpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfZDQ1NjUzYWU0ZTlmNGIzMjg2OTQyZjkxNWI1MmYxMjcuYmluZFBvcHVwKHBvcHVwX2RiMzY5ZjVhYTE2YTQ0NDJhZTMxYmJmYmY2NWJmNDk3KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzVlMzgzMGE4OWY3NTRiOWE5ZGI3MGJlNjIxZDAyMTgwID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTIuNDUwNDQzMjUwMDAwMDA2LC0xLjkzMTk2MTM0MDUyMjQzNzZdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwZmZiNCIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MGZmYjQiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfZGUxZGEzNDExN2I4NDAwNjkyNjI5ZDAzN2IyMWI1MzYpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfMDJjYzUwMzc2OWQ0NDdlNzgxMDMxMzdmODM3NGNkMjggPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfYzg1NDRjNDM1NzY3NDI3Zjk4MjhkNDJmNjA2NzI1ZjMgPSAkKCc8ZGl2IGlkPSJodG1sX2M4NTQ0YzQzNTc2NzQyN2Y5ODI4ZDQyZjYwNjcyNWYzIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5IYXJib3JuZSwgRWRnYmFzdG9uIENsdXN0ZXIgMjwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfMDJjYzUwMzc2OWQ0NDdlNzgxMDMxMzdmODM3NGNkMjguc2V0Q29udGVudChodG1sX2M4NTQ0YzQzNTc2NzQyN2Y5ODI4ZDQyZjYwNjcyNWYzKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzVlMzgzMGE4OWY3NTRiOWE5ZGI3MGJlNjIxZDAyMTgwLmJpbmRQb3B1cChwb3B1cF8wMmNjNTAzNzY5ZDQ0N2U3ODEwMzEzN2Y4Mzc0Y2QyOCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl85NGI3YTAyODk4NzY0MjY2YTA2YmQyMDkyNjA3Mzg3MCA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzUyLjQ4NzAzNjgsLTEuOTM3ODcwN10sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjZmYwMDAwIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiI2ZmMDAwMCIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9kZTFkYTM0MTE3Yjg0MDA2OTI2MjlkMDM3YjIxYjUzNik7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8wZDk3ZGRmYThmODM0Y2E3YWJlZjhjZTU2NTNiNGVkMyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9hNWY1M2VkNzUxNTU0ZjhjYWUxYjFjMWIzN2M0ZjhhMiA9ICQoJzxkaXYgaWQ9Imh0bWxfYTVmNTNlZDc1MTU1NGY4Y2FlMWIxYzFiMzdjNGY4YTIiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPldpbnNvbiBHcmVlbiwgSG9ja2xleSBDbHVzdGVyIDA8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzBkOTdkZGZhOGY4MzRjYTdhYmVmOGNlNTY1M2I0ZWQzLnNldENvbnRlbnQoaHRtbF9hNWY1M2VkNzUxNTU0ZjhjYWUxYjFjMWIzN2M0ZjhhMik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl85NGI3YTAyODk4NzY0MjY2YTA2YmQyMDkyNjA3Mzg3MC5iaW5kUG9wdXAocG9wdXBfMGQ5N2RkZmE4ZjgzNGNhN2FiZWY4Y2U1NjUzYjRlZDMpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfZjdlYjI4MTNiMDJhNDQwYWI0OTQyMDc5YTZhMmZiOGIgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi41MDk0NDQ3LC0xLjkxMTMxNjcxNTQ2MjE1ODZdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiI2ZmMDAwMCIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiNmZjAwMDAiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfZGUxZGEzNDExN2I4NDAwNjkyNjI5ZDAzN2IyMWI1MzYpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfYjIwNDlhMjIwNWM0NGQ5Zjg4YjdmY2VlMTM2YmRiM2EgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfZTMwYzBkZTIwYjEzNGExYTllODc2NzYxOWRiNDc4YmMgPSAkKCc8ZGl2IGlkPSJodG1sX2UzMGMwZGUyMGIxMzRhMWE5ZTg3Njc2MTlkYjQ3OGJjIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5Mb3plbGxzLCBOZXd0b3duLCBCaXJjaGZpZWxkIENsdXN0ZXIgMDwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfYjIwNDlhMjIwNWM0NGQ5Zjg4YjdmY2VlMTM2YmRiM2Euc2V0Q29udGVudChodG1sX2UzMGMwZGUyMGIxMzRhMWE5ZTg3Njc2MTlkYjQ3OGJjKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyX2Y3ZWIyODEzYjAyYTQ0MGFiNDk0MjA3OWE2YTJmYjhiLmJpbmRQb3B1cChwb3B1cF9iMjA0OWEyMjA1YzQ0ZDlmODhiN2ZjZWUxMzZiZGIzYSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl83MDJiODJkMGI3YjI0MWY5YWE5MmZmOTM4MmIxZmQ3NCA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzUyLjUzODQ4MzYsLTEuODYxMTAzNTExMjU5NzMxXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiNmZjAwMDAiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjZmYwMDAwIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2RlMWRhMzQxMTdiODQwMDY5MjYyOWQwMzdiMjFiNTM2KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzBmOWM0ZDk1YWU5MzQ3ZjA5ZGM0ZGYwMGI4NWIzZDc1ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzU2MDI3NzIyNWRhMjQ4NzdhZjdmMDRlYTU4MTg2OWUwID0gJCgnPGRpdiBpZD0iaHRtbF81NjAyNzcyMjVkYTI0ODc3YWY3ZjA0ZWE1ODE4NjllMCIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+RXJkaW5ndG9uLCBTdG9ja2xhbmQgR3JlZW4sIFNob3J0IEhlYXRoLCBQZXJyeSBDb21tb24gQ2x1c3RlciAwPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8wZjljNGQ5NWFlOTM0N2YwOWRjNGRmMDBiODViM2Q3NS5zZXRDb250ZW50KGh0bWxfNTYwMjc3MjI1ZGEyNDg3N2FmN2YwNGVhNTgxODY5ZTApOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfNzAyYjgyZDBiN2IyNDFmOWFhOTJmZjkzODJiMWZkNzQuYmluZFBvcHVwKHBvcHVwXzBmOWM0ZDk1YWU5MzQ3ZjA5ZGM0ZGYwMGI4NWIzZDc1KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzNlMGQ3NDkyZDFmMTQ4MTJiZGNjN2MyMjYxOTM5NDI2ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTIuNTI5Mzk0NTUsLTEuODMwODEyMDUyMzgxNDc0OF0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjZmYwMDAwIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiI2ZmMDAwMCIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9kZTFkYTM0MTE3Yjg0MDA2OTI2MjlkMDM3YjIxYjUzNik7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9mYzNmYTJjODkwYjk0NDFkYjlkNTA5Y2U3YTIwMzU4ZSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF85YmQ3YTliMmU2MjA0NTU3OTg4MGY2MTE5MjViOGFhMSA9ICQoJzxkaXYgaWQ9Imh0bWxfOWJkN2E5YjJlNjIwNDU1Nzk4ODBmNjExOTI1YjhhYTEiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkVyZGluZ3RvbiwgV3lsZGUgR3JlZW4sIFR5YnVybiBDbHVzdGVyIDA8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2ZjM2ZhMmM4OTBiOTQ0MWRiOWQ1MDljZTdhMjAzNThlLnNldENvbnRlbnQoaHRtbF85YmQ3YTliMmU2MjA0NTU3OTg4MGY2MTE5MjViOGFhMSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8zZTBkNzQ5MmQxZjE0ODEyYmRjYzdjMjI2MTkzOTQyNi5iaW5kUG9wdXAocG9wdXBfZmMzZmEyYzg5MGI5NDQxZGI5ZDUwOWNlN2EyMDM1OGUpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNzQwMzk3MWFjYjY3NGUzMGE2MDc0YjYwMTY4MjdkYzIgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi40NjE2OTg0LC0xLjc4Mjg0ODA4MTg3NTYwMzhdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiI2ZmMDAwMCIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiNmZjAwMDAiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfZGUxZGEzNDExN2I4NDAwNjkyNjI5ZDAzN2IyMWI1MzYpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZTIyMDgyYjVlYzUzNGVlY2JkMGQxMDNlNDcxZjMyOTIgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMWRlZmUzOTY4NTRkNGY4ZmJjZTU2Yzk1ODc0YzdiZTAgPSAkKCc8ZGl2IGlkPSJodG1sXzFkZWZlMzk2ODU0ZDRmOGZiY2U1NmM5NTg3NGM3YmUwIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5TaGVsZG9uLCBZYXJkbGV5IENsdXN0ZXIgMDwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZTIyMDgyYjVlYzUzNGVlY2JkMGQxMDNlNDcxZjMyOTIuc2V0Q29udGVudChodG1sXzFkZWZlMzk2ODU0ZDRmOGZiY2U1NmM5NTg3NGM3YmUwKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzc0MDM5NzFhY2I2NzRlMzBhNjA3NGI2MDE2ODI3ZGMyLmJpbmRQb3B1cChwb3B1cF9lMjIwODJiNWVjNTM0ZWVjYmQwZDEwM2U0NzFmMzI5Mik7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl9mMDVkNDNjOTkzZWQ0MDM4ODE1OGU1Njk2MGVkZjhhMCA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzUyLjQ0OTUyOTksLTEuODE5MjM3OF0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjZmYwMDAwIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiI2ZmMDAwMCIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9kZTFkYTM0MTE3Yjg0MDA2OTI2MjlkMDM3YjIxYjUzNik7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8xOGY5MjQyZGExMWM0MDA1ODcyMzZhNzRjOGFkMDk2MiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF80MDYzMzc3Zjk5NjA0ZGQ2ODI1YjMzMTBjNGNmMWVkYSA9ICQoJzxkaXYgaWQ9Imh0bWxfNDA2MzM3N2Y5OTYwNGRkNjgyNWIzMzEwYzRjZjFlZGEiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkFjb2NrcyBHcmVlbiBDbHVzdGVyIDA8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzE4ZjkyNDJkYTExYzQwMDU4NzIzNmE3NGM4YWQwOTYyLnNldENvbnRlbnQoaHRtbF80MDYzMzc3Zjk5NjA0ZGQ2ODI1YjMzMTBjNGNmMWVkYSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9mMDVkNDNjOTkzZWQ0MDM4ODE1OGU1Njk2MGVkZjhhMC5iaW5kUG9wdXAocG9wdXBfMThmOTI0MmRhMTFjNDAwNTg3MjM2YTc0YzhhZDA5NjIpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNDlkYmQ2MzViNDViNGZiMDgzODVjNTEzNzg0NWIxNTQgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi40Mjg1MDA3LC0xLjg0MDQwM10sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjZmYwMDAwIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiI2ZmMDAwMCIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9kZTFkYTM0MTE3Yjg0MDA2OTI2MjlkMDM3YjIxYjUzNik7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9jYzgwOGY1NGFmNjc0NDc1OWNhYzY2MzA0OTU4MTFiZSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8xZDJhZDllYjUwYzQ0MTMwYWNmMGEzYjRkMzJjZjdhMSA9ICQoJzxkaXYgaWQ9Imh0bWxfMWQyYWQ5ZWI1MGM0NDEzMGFjZjBhM2I0ZDMyY2Y3YTEiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkhhbGwgR3JlZW4gQ2x1c3RlciAwPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9jYzgwOGY1NGFmNjc0NDc1OWNhYzY2MzA0OTU4MTFiZS5zZXRDb250ZW50KGh0bWxfMWQyYWQ5ZWI1MGM0NDEzMGFjZjBhM2I0ZDMyY2Y3YTEpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfNDlkYmQ2MzViNDViNGZiMDgzODVjNTEzNzg0NWIxNTQuYmluZFBvcHVwKHBvcHVwX2NjODA4ZjU0YWY2NzQ0NzU5Y2FjNjYzMDQ5NTgxMWJlKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2Y5NTgxYTUzYTVmNDRjYmJhM2JlZTlhMWU0NzJmNjZkID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTIuNDI3Mzg4OSwtMS45MjY2NjgzXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiM4MDAwZmYiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjODAwMGZmIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2RlMWRhMzQxMTdiODQwMDY5MjYyOWQwMzdiMjFiNTM2KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzMxZWMyZjZlMzc4NTQ4OTJhYzIxODZlNDhkZDA2MzZlID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzc2ZjgxMzUwMjdmODQ3MGE5OWQ1ZTU4NDQ5YzA0YWY0ID0gJCgnPGRpdiBpZD0iaHRtbF83NmY4MTM1MDI3Zjg0NzBhOTlkNWU1ODQ0OWMwNGFmNCIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+Qm91cm52aWxsZSwgQ290dGVyaWRnZSwgU3RpcmNobGV5IENsdXN0ZXIgMTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfMzFlYzJmNmUzNzg1NDg5MmFjMjE4NmU0OGRkMDYzNmUuc2V0Q29udGVudChodG1sXzc2ZjgxMzUwMjdmODQ3MGE5OWQ1ZTU4NDQ5YzA0YWY0KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyX2Y5NTgxYTUzYTVmNDRjYmJhM2JlZTlhMWU0NzJmNjZkLmJpbmRQb3B1cChwb3B1cF8zMWVjMmY2ZTM3ODU0ODkyYWMyMTg2ZTQ4ZGQwNjM2ZSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8zNzcxOTI0NTgxOGQ0MWM1YTY4MTEzYmNkOWRhMjQzOSA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzUyLjQwODI5NTEsLTEuOTY1MTI0Nl0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjODAwMGZmIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzgwMDBmZiIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9kZTFkYTM0MTE3Yjg0MDA2OTI2MjlkMDM3YjIxYjUzNik7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9jZTU4YmEwZjA4NmQ0OGQ1OGY5YjMzYThkMDU0NzMxNSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8yNWFkZGNiNzgxMDI0Y2Y3YmFkZDNmZjcxMTQwYTlkZSA9ICQoJzxkaXYgaWQ9Imh0bWxfMjVhZGRjYjc4MTAyNGNmN2JhZGQzZmY3MTE0MGE5ZGUiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPk5vcnRoZmllbGQsIExvbmdicmlkZ2UsIFdlc3QgSGVhdGggQ2x1c3RlciAxPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9jZTU4YmEwZjA4NmQ0OGQ1OGY5YjMzYThkMDU0NzMxNS5zZXRDb250ZW50KGh0bWxfMjVhZGRjYjc4MTAyNGNmN2JhZGQzZmY3MTE0MGE5ZGUpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfMzc3MTkyNDU4MThkNDFjNWE2ODExM2JjZDlkYTI0MzkuYmluZFBvcHVwKHBvcHVwX2NlNThiYTBmMDg2ZDQ4ZDU4ZjliMzNhOGQwNTQ3MzE1KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2VhNGVjOGViNjViMzQ0ZjJiZTVlNzlmODIzOGJjZGU0ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTIuNDgzNDcwNywtMS43NzU3OTY2XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiNmZjAwMDAiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjZmYwMDAwIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2RlMWRhMzQxMTdiODQwMDY5MjYyOWQwMzdiMjFiNTM2KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzllYzM4NDhhYmZjNDQ5ODVhNjZhNDk5NzBlYzczYTUwID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzhhNDEzZWY3NTg3MjQ0Y2M5MTUwOGI2ZTA5MTA1MWM2ID0gJCgnPGRpdiBpZD0iaHRtbF84YTQxM2VmNzU4NzI0NGNjOTE1MDhiNmUwOTEwNTFjNiIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+S2l0dHMgR3JlZW4sIFN0ZWNoZm9yZCBDbHVzdGVyIDA8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzllYzM4NDhhYmZjNDQ5ODVhNjZhNDk5NzBlYzczYTUwLnNldENvbnRlbnQoaHRtbF84YTQxM2VmNzU4NzI0NGNjOTE1MDhiNmUwOTEwNTFjNik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9lYTRlYzhlYjY1YjM0NGYyYmU1ZTc5ZjgyMzhiY2RlNC5iaW5kUG9wdXAocG9wdXBfOWVjMzg0OGFiZmM0NDk4NWE2NmE0OTk3MGVjNzNhNTApOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfZjVhNmE5NjEyMGY3NDMyOWI3MGQ4NTQxZTNkZjM3YWIgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi40OTc5NzY4LC0xLjc5MTgxNDldLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwZmZiNCIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MGZmYjQiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfZGUxZGEzNDExN2I4NDAwNjkyNjI5ZDAzN2IyMWI1MzYpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNDFhYWU0OWRhYTUzNDZiNjlhYjU0NjgzMjc0ZTA0N2IgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfY2Q0NmVhZTNkNDllNDFkZTk1YjI5NDBkZjIxOTQwMTEgPSAkKCc8ZGl2IGlkPSJodG1sX2NkNDZlYWUzZDQ5ZTQxZGU5NWIyOTQwZGYyMTk0MDExIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5TaGFyZCBFbmQsIEJ1Y2tsYW5kIEVuZCBDbHVzdGVyIDI8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzQxYWFlNDlkYWE1MzQ2YjY5YWI1NDY4MzI3NGUwNDdiLnNldENvbnRlbnQoaHRtbF9jZDQ2ZWFlM2Q0OWU0MWRlOTViMjk0MGRmMjE5NDAxMSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9mNWE2YTk2MTIwZjc0MzI5YjcwZDg1NDFlM2RmMzdhYi5iaW5kUG9wdXAocG9wdXBfNDFhYWU0OWRhYTUzNDZiNjlhYjU0NjgzMjc0ZTA0N2IpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfYTBhZjJhMjNhOGE0NDMxZTgzNGVmOGI1NjNkODg5MmEgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi41MjEyNTkzLC0xLjc4NDU0OTRdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiI2ZmMDAwMCIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiNmZjAwMDAiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfZGUxZGEzNDExN2I4NDAwNjkyNjI5ZDAzN2IyMWI1MzYpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfY2JlNGQ3MDY4ZDM5NGY1Y2JkNjQzMWNlMjVlOWIyY2QgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfYjk0NWM3ODAwOWUyNDVkYWE2NDU5MDRiN2I3YmE0YWIgPSAkKCc8ZGl2IGlkPSJodG1sX2I5NDVjNzgwMDllMjQ1ZGFhNjQ1OTA0YjdiN2JhNGFiIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5DYXN0bGUgVmFsZSBDbHVzdGVyIDA8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2NiZTRkNzA2OGQzOTRmNWNiZDY0MzFjZTI1ZTliMmNkLnNldENvbnRlbnQoaHRtbF9iOTQ1Yzc4MDA5ZTI0NWRhYTY0NTkwNGI3YjdiYTRhYik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9hMGFmMmEyM2E4YTQ0MzFlODM0ZWY4YjU2M2Q4ODkyYS5iaW5kUG9wdXAocG9wdXBfY2JlNGQ3MDY4ZDM5NGY1Y2JkNjQzMWNlMjVlOWIyY2QpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfMDE0NzNhZTM3NjdmNDJhY2FhNjgyZjVmY2ExMGNlZjggPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi40ODU0NDE1LC0xLjc0NzI2MjddLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwZmZiNCIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MGZmYjQiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfZGUxZGEzNDExN2I4NDAwNjkyNjI5ZDAzN2IyMWI1MzYpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfOWEyZjU2ZjQ0ZjExNDZiMDg2YjdhYzZiZDM2N2IxYjQgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNWUzZDgzOTMzMzAyNDlhYmEyOTk4MGZkOTA2M2ViYjcgPSAkKCc8ZGl2IGlkPSJodG1sXzVlM2Q4MzkzMzMwMjQ5YWJhMjk5ODBmZDkwNjNlYmI3IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5DaGVsbXNsZXkgV29vZCwgTWFyc3RvbiBHcmVlbiwgS2luZ3NodXJzdCwgRm9yZGJyaWRnZSBDbHVzdGVyIDI8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzlhMmY1NmY0NGYxMTQ2YjA4NmI3YWM2YmQzNjdiMWI0LnNldENvbnRlbnQoaHRtbF81ZTNkODM5MzMzMDI0OWFiYTI5OTgwZmQ5MDYzZWJiNyk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8wMTQ3M2FlMzc2N2Y0MmFjYWE2ODJmNWZjYTEwY2VmOC5iaW5kUG9wdXAocG9wdXBfOWEyZjU2ZjQ0ZjExNDZiMDg2YjdhYzZiZDM2N2IxYjQpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfOWRlY2ZmNDFlOWVlNDhmYzhlYjdlNjhmNzQ5NDg1NWIgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi40MTQyNDA3LC0xLjkzMjYxNV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjZmYwMDAwIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiI2ZmMDAwMCIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9kZTFkYTM0MTE3Yjg0MDA2OTI2MjlkMDM3YjIxYjUzNik7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8xZjQwYzY0NGQ3ZDQ0NDMzYWU3YmEzZGFiOTdhODg0ZiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9kYzRkZDY1ZjgyNGU0MWIyYjVmYjZlYjRlYTQ1MmFkYyA9ICQoJzxkaXYgaWQ9Imh0bWxfZGM0ZGQ2NWY4MjRlNDFiMmI1ZmI2ZWI0ZWE0NTJhZGMiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPktpbmdzIE5vcnRvbiwgV2VzdCBIZWF0aCBDbHVzdGVyIDA8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzFmNDBjNjQ0ZDdkNDQ0MzNhZTdiYTNkYWI5N2E4ODRmLnNldENvbnRlbnQoaHRtbF9kYzRkZDY1ZjgyNGU0MWIyYjVmYjZlYjRlYTQ1MmFkYyk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl85ZGVjZmY0MWU5ZWU0OGZjOGViN2U2OGY3NDk0ODU1Yi5iaW5kUG9wdXAocG9wdXBfMWY0MGM2NDRkN2Q0NDQzM2FlN2JhM2RhYjk3YTg4NGYpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfZTc5N2ZjZTcwNDI1NGQzOGE4Y2I5ZTJiZDY5ZTEzMjggPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi41MzA5OTQ1LC0xLjkyODg2ODddLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiI2ZmMDAwMCIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiNmZjAwMDAiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfZGUxZGEzNDExN2I4NDAwNjkyNjI5ZDAzN2IyMWI1MzYpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfYzFiNTU3NmM2NDU1NGYxZTk4MDJiMWJiMGE2NzUxZGIgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMjBhMjg0ZTQ0Y2ZjNDU0MThhY2M1NjNiZTMyOTc0YjEgPSAkKCc8ZGl2IGlkPSJodG1sXzIwYTI4NGU0NGNmYzQ1NDE4YWNjNTYzYmUzMjk3NGIxIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5QZXJyeSBCYXJyLCBHcmVhdCBCYXJyLCBIYW1zdGVhZCBDbHVzdGVyIDA8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2MxYjU1NzZjNjQ1NTRmMWU5ODAyYjFiYjBhNjc1MWRiLnNldENvbnRlbnQoaHRtbF8yMGEyODRlNDRjZmM0NTQxOGFjYzU2M2JlMzI5NzRiMSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9lNzk3ZmNlNzA0MjU0ZDM4YThjYjllMmJkNjllMTMyOC5iaW5kUG9wdXAocG9wdXBfYzFiNTU3NmM2NDU1NGYxZTk4MDJiMWJiMGE2NzUxZGIpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfYzdiNmIwN2ExOTdmNDc5MTliZTQzNDJjOTFhOTg0MTcgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi41MzA5OTQ1LC0xLjkyODg2ODddLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwZmZiNCIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MGZmYjQiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfZGUxZGEzNDExN2I4NDAwNjkyNjI5ZDAzN2IyMWI1MzYpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNTFhZmIwODBkNTQzNGIyNDk4ZTljOTI5ZTVmMGIyNzggPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMDliNjU4MWExOGVmNDNmMmJmMjYwYTE4MjY1ZDczMjkgPSAkKCc8ZGl2IGlkPSJodG1sXzA5YjY1ODFhMThlZjQzZjJiZjI2MGExODI2NWQ3MzI5IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5HcmVhdCBCYXJyLCBIYW1zdGVhZCBDbHVzdGVyIDI8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzUxYWZiMDgwZDU0MzRiMjQ5OGU5YzkyOWU1ZjBiMjc4LnNldENvbnRlbnQoaHRtbF8wOWI2NTgxYTE4ZWY0M2YyYmYyNjBhMTgyNjVkNzMyOSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9jN2I2YjA3YTE5N2Y0NzkxOWJlNDM0MmM5MWE5ODQxNy5iaW5kUG9wdXAocG9wdXBfNTFhZmIwODBkNTQzNGIyNDk4ZTljOTI5ZTVmMGIyNzgpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNjZlNzZiMGFjZDUxNDk4NGE1N2JkYWI0N2RhNDk0MmEgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi41NTE5NTE1LC0xLjkyNTcxOF0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjZmYwMDAwIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiI2ZmMDAwMCIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9kZTFkYTM0MTE3Yjg0MDA2OTI2MjlkMDM3YjIxYjUzNik7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9mNjQ2ZmM0YTZhMmI0NTJhYjAyNzdkYjIxMmViOTEzMiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8yN2Y2ZDRmMDFmZjg0ZjdmOTQ0MDBmYjZkODc3YjFlNCA9ICQoJzxkaXYgaWQ9Imh0bWxfMjdmNmQ0ZjAxZmY4NGY3Zjk0NDAwZmI2ZDg3N2IxZTQiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPlBlcnJ5IEJhcnIsIEtpbmdzdGFuZGluZywgR3JlYXQgQmFyciBDbHVzdGVyIDA8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2Y2NDZmYzRhNmEyYjQ1MmFiMDI3N2RiMjEyZWI5MTMyLnNldENvbnRlbnQoaHRtbF8yN2Y2ZDRmMDFmZjg0ZjdmOTQ0MDBmYjZkODc3YjFlNCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl82NmU3NmIwYWNkNTE0OTg0YTU3YmRhYjQ3ZGE0OTQyYS5iaW5kUG9wdXAocG9wdXBfZjY0NmZjNGE2YTJiNDUyYWIwMjc3ZGIyMTJlYjkxMzIpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNTQ0OWMxODhkNThjNDE1NGE5NmVkNTYwYjNhNmUyMGYgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1Mi4zODAwNzkxLC0xLjg2NTQ1NzJdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiI2ZmMDAwMCIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiNmZjAwMDAiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfZGUxZGEzNDExN2I4NDAwNjkyNjI5ZDAzN2IyMWI1MzYpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNmIxNDQ1ZDdkYzc1NDYxNmI5ZjcxZGM4YTU2N2QzMjcgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMGIxYzU1MDJmMTRhNDA2YjllZDlkZWQwNzcwMjZkNWIgPSAkKCc8ZGl2IGlkPSJodG1sXzBiMWM1NTAyZjE0YTQwNmI5ZWQ5ZGVkMDc3MDI2ZDViIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5Ib2xseXdvb2QsIFd5dGhhbGwgQ2x1c3RlciAwPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF82YjE0NDVkN2RjNzU0NjE2YjlmNzFkYzhhNTY3ZDMyNy5zZXRDb250ZW50KGh0bWxfMGIxYzU1MDJmMTRhNDA2YjllZDlkZWQwNzcwMjZkNWIpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfNTQ0OWMxODhkNThjNDE1NGE5NmVkNTYwYjNhNmUyMGYuYmluZFBvcHVwKHBvcHVwXzZiMTQ0NWQ3ZGM3NTQ2MTZiOWY3MWRjOGE1NjdkMzI3KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzk1Y2JmZTA1NGFmMDRlMzFiZDMwOWZjY2YxNTY5YTU2ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTIuMzUwNzEyMywtMS45NTc5MTE0XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiNmZjAwMDAiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjZmYwMDAwIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2RlMWRhMzQxMTdiODQwMDY5MjYyOWQwMzdiMjFiNTM2KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2I4ZDRmYTIyZmI5NDQ5YWNiYzYxMjhjNDhmYWVkNzc3ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2NjZmI3Yjc2YzVmNzQ5NjRiZjhmMTIyOGFmMjY5MDAwID0gJCgnPGRpdiBpZD0iaHRtbF9jY2ZiN2I3NmM1Zjc0OTY0YmY4ZjEyMjhhZjI2OTAwMCIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+QWx2ZWNodXJjaCBDbHVzdGVyIDA8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2I4ZDRmYTIyZmI5NDQ5YWNiYzYxMjhjNDhmYWVkNzc3LnNldENvbnRlbnQoaHRtbF9jY2ZiN2I3NmM1Zjc0OTY0YmY4ZjEyMjhhZjI2OTAwMCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl85NWNiZmUwNTRhZjA0ZTMxYmQzMDlmY2NmMTU2OWE1Ni5iaW5kUG9wdXAocG9wdXBfYjhkNGZhMjJmYjk0NDlhY2JjNjEyOGM0OGZhZWQ3NzcpOwoKICAgICAgICAgICAgCiAgICAgICAgCjwvc2NyaXB0Pg== onload=\"this.contentDocument.open();this.contentDocument.write(atob(this.getAttribute('data-html')));this.contentDocument.close();\" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>",
                        "text/plain": "<folium.folium.Map at 0x7f2be7de8be0>"
                    },
                    "execution_count": 41,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "# Birmingham's coordinates\nlat = 52.4862\nlon = -1.8904\nmap_clusters = folium.Map(location=[lat,lon], zoom_start=10)\n\n# set color scheme for the clusters\nx = np.arange(kclusters)\nys = [i + x + (i*x)**2 for i in range(kclusters)]\ncolors_array = cm.rainbow(np.linspace(0, 1, len(ys)))\nrainbow = [colors.rgb2hex(i) for i in colors_array]\n\n# add markers to the map\nmarkers_colors = []\nfor lat, lon, poi, cluster in zip(bir_merged['latitude'], bir_merged['longitude'], bir_merged['Neighborhood'], bir_merged['Cluster Labels']):\n    label = folium.Popup(str(poi) + ' Cluster ' + str(cluster), parse_html=True)\n    folium.CircleMarker(\n        [lat, lon],\n        radius=5,\n        popup=label,\n        color=rainbow[cluster-1],\n        fill=True,\n        fill_color=rainbow[cluster-1],\n        fill_opacity=0.7).add_to(map_clusters)\n       \nmap_clusters"
        },
        {
            "cell_type": "code",
            "execution_count": 42,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Neighborhood</th>\n      <th>1st Most Common Venue</th>\n      <th>2nd Most Common Venue</th>\n      <th>3rd Most Common Venue</th>\n      <th>4th Most Common Venue</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2</th>\n      <td>Aston, Birchfield, Birmingham , Witton</td>\n      <td>Bar</td>\n      <td>Wine Shop</td>\n      <td>Garden</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Bordesley Green, Bordesley</td>\n      <td>Gaming Cafe</td>\n      <td>Wine Shop</td>\n      <td>Indian Restaurant</td>\n      <td>English Restaurant</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Small Heath</td>\n      <td>Pub</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Moseley, Billesley</td>\n      <td>Cosmetics Shop</td>\n      <td>Department Store</td>\n      <td>English Restaurant</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Kings Heath, Yardley Wood, Druids Heath, Hight...</td>\n      <td>Plaza</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Edgbaston,</td>\n      <td>Italian Restaurant</td>\n      <td>Wine Shop</td>\n      <td>Garden</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Ladywood</td>\n      <td>Concert Hall</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Winson Green, Hockley</td>\n      <td>Pub</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Lozells, Newtown, Birchfield</td>\n      <td>Indie Movie Theater</td>\n      <td>Indian Restaurant</td>\n      <td>English Restaurant</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Erdington, Stockland Green, Short Heath, Perry...</td>\n      <td>Italian Restaurant</td>\n      <td>Wine Shop</td>\n      <td>Garden</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Erdington, Wylde Green, Tyburn</td>\n      <td>Beer Bar</td>\n      <td>Wine Shop</td>\n      <td>Garden</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Sheldon, Yardley</td>\n      <td>Plaza</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Acocks Green</td>\n      <td>History Museum</td>\n      <td>Wine Shop</td>\n      <td>Gaming Cafe</td>\n      <td>English Restaurant</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>Hall Green</td>\n      <td>Furniture / Home Store</td>\n      <td>Wine Shop</td>\n      <td>Indian Restaurant</td>\n      <td>English Restaurant</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>Kitts Green, Stechford</td>\n      <td>Music Venue</td>\n      <td>Wine Shop</td>\n      <td>Garden</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>Castle Vale</td>\n      <td>Restaurant</td>\n      <td>Department Store</td>\n      <td>English Restaurant</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>Kings Norton, West Heath</td>\n      <td>Cocktail Bar</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>Perry Barr, Great Barr, Hamstead</td>\n      <td>Beer Bar</td>\n      <td>Wine Shop</td>\n      <td>Garden</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>Perry Barr, Kingstanding, Great Barr</td>\n      <td>History Museum</td>\n      <td>Wine Shop</td>\n      <td>Gaming Cafe</td>\n      <td>English Restaurant</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>Hollywood, Wythall</td>\n      <td>Pub</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>Alvechurch</td>\n      <td>Pizza Place</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "                                         Neighborhood   1st Most Common Venue  \\\n2              Aston, Birchfield, Birmingham , Witton                     Bar   \n4                          Bordesley Green, Bordesley             Gaming Cafe   \n5                                         Small Heath                     Pub   \n6                                  Moseley, Billesley          Cosmetics Shop   \n7   Kings Heath, Yardley Wood, Druids Heath, Hight...                   Plaza   \n8                                          Edgbaston,      Italian Restaurant   \n9                                            Ladywood            Concert Hall   \n11                              Winson Green, Hockley                     Pub   \n12                       Lozells, Newtown, Birchfield     Indie Movie Theater   \n13  Erdington, Stockland Green, Short Heath, Perry...      Italian Restaurant   \n14                     Erdington, Wylde Green, Tyburn                Beer Bar   \n15                                   Sheldon, Yardley                   Plaza   \n16                                       Acocks Green          History Museum   \n17                                         Hall Green  Furniture / Home Store   \n20                             Kitts Green, Stechford             Music Venue   \n22                                        Castle Vale              Restaurant   \n24                           Kings Norton, West Heath            Cocktail Bar   \n25                   Perry Barr, Great Barr, Hamstead                Beer Bar   \n27               Perry Barr, Kingstanding, Great Barr          History Museum   \n28                                 Hollywood, Wythall                     Pub   \n29                                         Alvechurch             Pizza Place   \n\n   2nd Most Common Venue 3rd Most Common Venue 4th Most Common Venue  \n2              Wine Shop                Garden  Fast Food Restaurant  \n4              Wine Shop     Indian Restaurant    English Restaurant  \n5              Wine Shop      Department Store  Fast Food Restaurant  \n6       Department Store    English Restaurant  Fast Food Restaurant  \n7              Wine Shop      Department Store  Fast Food Restaurant  \n8              Wine Shop                Garden  Fast Food Restaurant  \n9              Wine Shop      Department Store  Fast Food Restaurant  \n11             Wine Shop      Department Store  Fast Food Restaurant  \n12     Indian Restaurant    English Restaurant  Fast Food Restaurant  \n13             Wine Shop                Garden  Fast Food Restaurant  \n14             Wine Shop                Garden  Fast Food Restaurant  \n15             Wine Shop      Department Store  Fast Food Restaurant  \n16             Wine Shop           Gaming Cafe    English Restaurant  \n17             Wine Shop     Indian Restaurant    English Restaurant  \n20             Wine Shop                Garden  Fast Food Restaurant  \n22      Department Store    English Restaurant  Fast Food Restaurant  \n24             Wine Shop      Department Store  Fast Food Restaurant  \n25             Wine Shop                Garden  Fast Food Restaurant  \n27             Wine Shop           Gaming Cafe    English Restaurant  \n28             Wine Shop      Department Store  Fast Food Restaurant  \n29             Wine Shop      Department Store  Fast Food Restaurant  "
                    },
                    "execution_count": 42,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "b1 = bir_merged.loc[bir_merged['Cluster Labels'] == 0, :]\nb1 = b1[['Neighborhood','1st Most Common Venue','2nd Most Common Venue','3rd Most Common Venue','4th Most Common Venue']]\nb1"
        },
        {
            "cell_type": "code",
            "execution_count": 43,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Neighborhood</th>\n      <th>1st Most Common Venue</th>\n      <th>2nd Most Common Venue</th>\n      <th>3rd Most Common Venue</th>\n      <th>4th Most Common Venue</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Birmingham City Centre, New Street</td>\n      <td>Coffee Shop</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Birmingham City Centre, Newhall Street</td>\n      <td>Coffee Shop</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Nechells, Vauxhall</td>\n      <td>Coffee Shop</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>Bournville, Cotteridge, Stirchley</td>\n      <td>Coffee Shop</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>Northfield, Longbridge, West Heath</td>\n      <td>Coffee Shop</td>\n      <td>Wine Shop</td>\n      <td>Department Store</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "                              Neighborhood 1st Most Common Venue  \\\n0       Birmingham City Centre, New Street           Coffee Shop   \n1   Birmingham City Centre, Newhall Street           Coffee Shop   \n3                       Nechells, Vauxhall           Coffee Shop   \n18       Bournville, Cotteridge, Stirchley           Coffee Shop   \n19      Northfield, Longbridge, West Heath           Coffee Shop   \n\n   2nd Most Common Venue 3rd Most Common Venue 4th Most Common Venue  \n0              Wine Shop      Department Store  Fast Food Restaurant  \n1              Wine Shop      Department Store  Fast Food Restaurant  \n3              Wine Shop      Department Store  Fast Food Restaurant  \n18             Wine Shop      Department Store  Fast Food Restaurant  \n19             Wine Shop      Department Store  Fast Food Restaurant  "
                    },
                    "execution_count": 43,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "b2 = bir_merged.loc[bir_merged['Cluster Labels'] == 1, :]\nb2 = b2[['Neighborhood','1st Most Common Venue','2nd Most Common Venue','3rd Most Common Venue','4th Most Common Venue']]\nb2"
        },
        {
            "cell_type": "code",
            "execution_count": 44,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Neighborhood</th>\n      <th>1st Most Common Venue</th>\n      <th>2nd Most Common Venue</th>\n      <th>3rd Most Common Venue</th>\n      <th>4th Most Common Venue</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>10</th>\n      <td>Harborne, Edgbaston</td>\n      <td>Indian Restaurant</td>\n      <td>Wine Shop</td>\n      <td>English Restaurant</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>Shard End, Buckland End</td>\n      <td>Indian Restaurant</td>\n      <td>Wine Shop</td>\n      <td>English Restaurant</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>Chelmsley Wood, Marston Green, Kingshurst, For...</td>\n      <td>Indian Restaurant</td>\n      <td>Wine Shop</td>\n      <td>English Restaurant</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>Great Barr, Hamstead</td>\n      <td>Indian Restaurant</td>\n      <td>Wine Shop</td>\n      <td>English Restaurant</td>\n      <td>Fast Food Restaurant</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "                                         Neighborhood 1st Most Common Venue  \\\n10                                Harborne, Edgbaston     Indian Restaurant   \n21                            Shard End, Buckland End     Indian Restaurant   \n23  Chelmsley Wood, Marston Green, Kingshurst, For...     Indian Restaurant   \n26                               Great Barr, Hamstead     Indian Restaurant   \n\n   2nd Most Common Venue 3rd Most Common Venue 4th Most Common Venue  \n10             Wine Shop    English Restaurant  Fast Food Restaurant  \n21             Wine Shop    English Restaurant  Fast Food Restaurant  \n23             Wine Shop    English Restaurant  Fast Food Restaurant  \n26             Wine Shop    English Restaurant  Fast Food Restaurant  "
                    },
                    "execution_count": 44,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "b3 = bir_merged.loc[bir_merged['Cluster Labels'] == 2, :]\nb3 = b3[['Neighborhood','1st Most Common Venue','2nd Most Common Venue','3rd Most Common Venue','4th Most Common Venue']]\nb3"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Observations\n\n- If you are an Indian, check out Edgbaston, Buckland End, Kingshearst and Hamstead.\n- If close access to coffee shops is a must for you, check out the City Centre, Vauxhall, Stirchley and West Heath.\n- If you like non-veg, many neighborhoods in Birmingham have Fried Chicken Joints."
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Manchester"
        },
        {
            "cell_type": "code",
            "execution_count": 45,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div style=\"width:100%;\"><div style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"><span style=\"color:#565656\">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe src=\"about:blank\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" data-html=PCFET0NUWVBFIGh0bWw+CjxoZWFkPiAgICAKICAgIDxtZXRhIGh0dHAtZXF1aXY9ImNvbnRlbnQtdHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PVVURi04IiAvPgogICAgPHNjcmlwdD5MX1BSRUZFUl9DQU5WQVMgPSBmYWxzZTsgTF9OT19UT1VDSCA9IGZhbHNlOyBMX0RJU0FCTEVfM0QgPSBmYWxzZTs8L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2FqYXguZ29vZ2xlYXBpcy5jb20vYWpheC9saWJzL2pxdWVyeS8xLjExLjEvanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvanMvYm9vdHN0cmFwLm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuanMiPjwvc2NyaXB0PgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmNzcyIvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9jc3MvYm9vdHN0cmFwLm1pbi5jc3MiLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvY3NzL2Jvb3RzdHJhcC10aGVtZS5taW4uY3NzIi8+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuNi4zL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyIvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9MZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy8yLjAuMi9sZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy5jc3MiLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9yYXdnaXQuY29tL3B5dGhvbi12aXN1YWxpemF0aW9uL2ZvbGl1bS9tYXN0ZXIvZm9saXVtL3RlbXBsYXRlcy9sZWFmbGV0LmF3ZXNvbWUucm90YXRlLmNzcyIvPgogICAgPHN0eWxlPmh0bWwsIGJvZHkge3dpZHRoOiAxMDAlO2hlaWdodDogMTAwJTttYXJnaW46IDA7cGFkZGluZzogMDt9PC9zdHlsZT4KICAgIDxzdHlsZT4jbWFwIHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtib3R0b206MDtyaWdodDowO2xlZnQ6MDt9PC9zdHlsZT4KICAgIAogICAgICAgICAgICA8c3R5bGU+ICNtYXBfYjFhYTQ5NjU5MzlhNGMwODk1NjkzYzkwMmM4MWY0MzggewogICAgICAgICAgICAgICAgcG9zaXRpb24gOiByZWxhdGl2ZTsKICAgICAgICAgICAgICAgIHdpZHRoIDogMTAwLjAlOwogICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAuMCU7CiAgICAgICAgICAgICAgICBsZWZ0OiAwLjAlOwogICAgICAgICAgICAgICAgdG9wOiAwLjAlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICA8L3N0eWxlPgogICAgICAgIAo8L2hlYWQ+Cjxib2R5PiAgICAKICAgIAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb2xpdW0tbWFwIiBpZD0ibWFwX2IxYWE0OTY1OTM5YTRjMDg5NTY5M2M5MDJjODFmNDM4IiA+PC9kaXY+CiAgICAgICAgCjwvYm9keT4KPHNjcmlwdD4gICAgCiAgICAKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGJvdW5kcyA9IG51bGw7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcF9iMWFhNDk2NTkzOWE0YzA4OTU2OTNjOTAyYzgxZjQzOCA9IEwubWFwKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21hcF9iMWFhNDk2NTkzOWE0YzA4OTU2OTNjOTAyYzgxZjQzOCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2VudGVyOiBbNTMuNDgwOCwtMi4yNDI2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpvb206IDEwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4Qm91bmRzOiBib3VuZHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXllcnM6IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ybGRDb3B5SnVtcDogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcnM6IEwuQ1JTLkVQU0czODU3CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgdGlsZV9sYXllcl9mZGYyNzgzNjBmY2Y0YjViOThjODMxYWQ1ZDJjYTM4OCA9IEwudGlsZUxheWVyKAogICAgICAgICAgICAgICAgJ2h0dHBzOi8ve3N9LnRpbGUub3BlbnN0cmVldG1hcC5vcmcve3p9L3t4fS97eX0ucG5nJywKICAgICAgICAgICAgICAgIHsKICAiYXR0cmlidXRpb24iOiBudWxsLAogICJkZXRlY3RSZXRpbmEiOiBmYWxzZSwKICAibWF4Wm9vbSI6IDE4LAogICJtaW5ab29tIjogMSwKICAibm9XcmFwIjogZmFsc2UsCiAgInN1YmRvbWFpbnMiOiAiYWJjIgp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9iMWFhNDk2NTkzOWE0YzA4OTU2OTNjOTAyYzgxZjQzOCk7CiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfMjg3MjI1ODUwZTU4NGIzMmE0NDIwMWFmMTgxN2UxMmEgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1My40ODIwMzk5LC0yLjIzOTQ2NjJdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwMDBmZiIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MDAwZmYiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYjFhYTQ5NjU5MzlhNGMwODk1NjkzYzkwMmM4MWY0MzgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZDdiMWY0NDczZTlmNDdkMzgwNjg4ZWQ3YWY0OGM2N2IgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNDBhNDZlNGUyZjAxNDEzNjgzMWRiNTJlNGRhNTFiODkgPSAkKCc8ZGl2IGlkPSJodG1sXzQwYTQ2ZTRlMmYwMTQxMzY4MzFkYjUyZTRkYTUxYjg5IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5QaWNjYWRpbGx5LCBDaXR5IENlbnRyZSwgTWFya2V0IFN0cmVldCBDbHVzdGVyIDE8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2Q3YjFmNDQ3M2U5ZjQ3ZDM4MDY4OGVkN2FmNDhjNjdiLnNldENvbnRlbnQoaHRtbF80MGE0NmU0ZTJmMDE0MTM2ODMxZGI1MmU0ZGE1MWI4OSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8yODcyMjU4NTBlNTg0YjMyYTQ0MjAxYWYxODE3ZTEyYS5iaW5kUG9wdXAocG9wdXBfZDdiMWY0NDczZTlmNDdkMzgwNjg4ZWQ3YWY0OGM2N2IpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNWNiNGIxNTA1Y2Y4NDE5YmFlMTA5ZjhkOGRjNjNmNjAgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1My40NzQwOTYxLC0yLjI1MTA2M10sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjODBmZmI0IiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzgwZmZiNCIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9iMWFhNDk2NTkzOWE0YzA4OTU2OTNjOTAyYzgxZjQzOCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF81YzQ3ZDg3MGQwM2Q0YzA4OGIyYWQ3MGI5MmRmMWE0NSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9hN2MxYzVjZDhlOTM0NDM3YTU1ZjNhM2JkMTEwNGZmMiA9ICQoJzxkaXYgaWQ9Imh0bWxfYTdjMWM1Y2Q4ZTkzNDQzN2E1NWYzYTNiZDExMDRmZjIiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkRlYW5zZ2F0ZSwgQ2l0eSBDZW50cmUgQ2x1c3RlciAyPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF81YzQ3ZDg3MGQwM2Q0YzA4OGIyYWQ3MGI5MmRmMWE0NS5zZXRDb250ZW50KGh0bWxfYTdjMWM1Y2Q4ZTkzNDQzN2E1NWYzYTNiZDExMDRmZjIpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfNWNiNGIxNTA1Y2Y4NDE5YmFlMTA5ZjhkOGRjNjNmNjAuYmluZFBvcHVwKHBvcHVwXzVjNDdkODcwZDAzZDRjMDg4YjJhZDcwYjkyZGYxYTQ1KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzg1YTg0OTYxOTBhZjQ5N2ZhNWM3NWY5NDI5N2IyYWNhID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTMuNDczMjA5NywtMi4yNTM3NjA5XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiM4MDAwZmYiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjODAwMGZmIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2IxYWE0OTY1OTM5YTRjMDg5NTY5M2M5MDJjODFmNDM4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzM5ZTEyNTg0MGNmODQ2Y2I4ZjI4OWFhYjA3NzczOThlID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzBjZWUwOGE5MWY5MjRhY2ZhY2JjYjhkMzRjZDVmOGE5ID0gJCgnPGRpdiBpZD0iaHRtbF8wY2VlMDhhOTFmOTI0YWNmYWNiY2I4ZDM0Y2Q1ZjhhOSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+Q2l0eSBDZW50cmUsIERlYW5zZ2F0ZSwgQ2FzdGxlZmllbGQgQ2x1c3RlciAxPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8zOWUxMjU4NDBjZjg0NmNiOGYyODlhYWIwNzc3Mzk4ZS5zZXRDb250ZW50KGh0bWxfMGNlZTA4YTkxZjkyNGFjZmFjYmNiOGQzNGNkNWY4YTkpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfODVhODQ5NjE5MGFmNDk3ZmE1Yzc1Zjk0Mjk3YjJhY2EuYmluZFBvcHVwKHBvcHVwXzM5ZTEyNTg0MGNmODQ2Y2I4ZjI4OWFhYjA3NzczOThlKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2RjZTc3M2MwZDc2ZjQ2Nzg4YzllYWRmYTJmZjAzMWMxID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTMuNTA5MDIzOTUsLTIuMjI5NTU1NzcxNjI3MDIxM10sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjODAwMGZmIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzgwMDBmZiIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9iMWFhNDk2NTkzOWE0YzA4OTU2OTNjOTAyYzgxZjQzOCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8zYmY5ZTJlZWM2ZDA0Mjg5OGNjYzE3ZjM1ZDkwZmY1OCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF84YTEyMGEzNzA5OWM0OWE4YjE0NTg5MTkwZjQ1ZjU1MiA9ICQoJzxkaXYgaWQ9Imh0bWxfOGExMjBhMzcwOTljNDlhOGIxNDU4OTE5MGY0NWY1NTIiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkNydW1wc2FsbCwgQ2hlZXRoYW0gSGlsbCBDbHVzdGVyIDE8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzNiZjllMmVlYzZkMDQyODk4Y2NjMTdmMzVkOTBmZjU4LnNldENvbnRlbnQoaHRtbF84YTEyMGEzNzA5OWM0OWE4YjE0NTg5MTkwZjQ1ZjU1Mik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9kY2U3NzNjMGQ3NmY0Njc4OGM5ZWFkZmEyZmYwMzFjMS5iaW5kUG9wdXAocG9wdXBfM2JmOWUyZWVjNmQwNDI4OThjY2MxN2YzNWQ5MGZmNTgpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfYzFmNDJkOWNhYjA0NDZiMTg4ZmFlM2UyOGQ2N2E1OTkgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1My41MTY5NDk1LC0yLjIxMzE3MTZdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwMDBmZiIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MDAwZmYiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYjFhYTQ5NjU5MzlhNGMwODk1NjkzYzkwMmM4MWY0MzgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNTMyNDgwZWQxNTlkNDZlNDg5ZDJkYjE4YTBjNGU1MzYgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNWUzZmU3N2NiOGE3NDM0NTkzOTE0ZDc2NjM4NWU4MDAgPSAkKCc8ZGl2IGlkPSJodG1sXzVlM2ZlNzdjYjhhNzQzNDU5MzkxNGQ3NjYzODVlODAwIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5IYXJwdXJoZXksIEJsYWNrbGV5IENsdXN0ZXIgMTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfNTMyNDgwZWQxNTlkNDZlNDg5ZDJkYjE4YTBjNGU1MzYuc2V0Q29udGVudChodG1sXzVlM2ZlNzdjYjhhNzQzNDU5MzkxNGQ3NjYzODVlODAwKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyX2MxZjQyZDljYWIwNDQ2YjE4OGZhZTNlMjhkNjdhNTk5LmJpbmRQb3B1cChwb3B1cF81MzI0ODBlZDE1OWQ0NmU0ODlkMmRiMThhMGM0ZTUzNik7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl9lODg1OWRlZjYyNmQ0YmZlOTliNTZmOWQzZmE3M2FkNSA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzUzLjQ3MTc1MTYsLTIuMzIwOTI3Nl0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjODAwMGZmIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzgwMDBmZiIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9iMWFhNDk2NTkzOWE0YzA4OTU2OTNjOTAyYzgxZjQzOCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF80ZjI3N2RhMjc0NTU0ODc0OTliN2E3YTZhMWY4YzI0YyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9jYTFkNTBhZDhlYTM0YTkyOTk3OWNhZDJjZmY3Y2UzZCA9ICQoJzxkaXYgaWQ9Imh0bWxfY2ExZDUwYWQ4ZWEzNGE5Mjk5NzljYWQyY2ZmN2NlM2QiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPlRyYWZmb3JkIFBhcmssIFRoZSBUcmFmZm9yZCBDZW50cmUgQ2x1c3RlciAxPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF80ZjI3N2RhMjc0NTU0ODc0OTliN2E3YTZhMWY4YzI0Yy5zZXRDb250ZW50KGh0bWxfY2ExZDUwYWQ4ZWEzNGE5Mjk5NzljYWQyY2ZmN2NlM2QpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfZTg4NTlkZWY2MjZkNGJmZTk5YjU2ZjlkM2ZhNzNhZDUuYmluZFBvcHVwKHBvcHVwXzRmMjc3ZGEyNzQ1NTQ4NzQ5OWI3YTdhNmExZjhjMjRjKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzlkNWNjNmNhNjJhMDQ5ZDRiNWE5MWIzMmMxZWVjNWE3ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTMuNDQwODAxOSwtMi4xODgzMDg3MDU1NzI3XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiNmZjAwMDAiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjZmYwMDAwIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2IxYWE0OTY1OTM5YTRjMDg5NTY5M2M5MDJjODFmNDM4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzk3Yzk5ZjExNDUzMTQyZDNhOThjMjI0YTJmMGYyMWIwID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzU1NTk0YTE0NjlhNzQ3OGU4ZjZmMmUxODRkNzYyZTYxID0gJCgnPGRpdiBpZD0iaHRtbF81NTU5NGExNDY5YTc0NzhlOGY2ZjJlMTg0ZDc2MmU2MSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+TGV2ZW5zaHVsbWUsIEJ1cm5hZ2UgQ2x1c3RlciAwPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF85N2M5OWYxMTQ1MzE0MmQzYTk4YzIyNGEyZjBmMjFiMC5zZXRDb250ZW50KGh0bWxfNTU1OTRhMTQ2OWE3NDc4ZThmNmYyZTE4NGQ3NjJlNjEpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfOWQ1Y2M2Y2E2MmEwNDlkNGI1YTkxYjMyYzFlZWM1YTcuYmluZFBvcHVwKHBvcHVwXzk3Yzk5ZjExNDUzMTQyZDNhOThjMjI0YTJmMGYyMWIwKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzRjNWFkODBkZDMzMTRkZWFhMjFhYjU3Y2JmNjRjNjZjID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTMuNDMyNzgyLC0yLjI0OTMxMjldLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwMDBmZiIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MDAwZmYiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYjFhYTQ5NjU5MzlhNGMwODk1NjkzYzkwMmM4MWY0MzgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZjk2OGRjYTdiNjAzNDRiMGI0YWRhOTA4ZmI3ODgzYTUgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNTM1ODg2ZTQ4YTJlNGNlZWI4MjcyMjBjMWYzYTk1NjQgPSAkKCc8ZGl2IGlkPSJodG1sXzUzNTg4NmU0OGEyZTRjZWViODI3MjIwYzFmM2E5NTY0IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5EaWRzYnVyeSwgV2l0aGluZ3RvbiBDbHVzdGVyIDE8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2Y5NjhkY2E3YjYwMzQ0YjBiNGFkYTkwOGZiNzg4M2E1LnNldENvbnRlbnQoaHRtbF81MzU4ODZlNDhhMmU0Y2VlYjgyNzIyMGMxZjNhOTU2NCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl80YzVhZDgwZGQzMzE0ZGVhYTIxYWI1N2NiZjY0YzY2Yy5iaW5kUG9wdXAocG9wdXBfZjk2OGRjYTdiNjAzNDRiMGI0YWRhOTA4ZmI3ODgzYTUpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNGQxMGYxNDY4YzMzNGI2MmI5YWM1NTY3ODM0MGQ1MTcgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1My40MzU0ODY3LC0yLjI3MzUwMzJdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwMDBmZiIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MDAwZmYiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYjFhYTQ5NjU5MzlhNGMwODk1NjkzYzkwMmM4MWY0MzgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZGJhMDEzMDkzZjVmNDAyY2EwZjM3Y2U2NmMwYjZhYzAgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfZDFkYWMyOTQwNTI1NDU5ZTkwZmQ5ODlmZGM1NmVjNTYgPSAkKCc8ZGl2IGlkPSJodG1sX2QxZGFjMjk0MDUyNTQ1OWU5MGZkOTg5ZmRjNTZlYzU2IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5DaG9ybHRvbi1jdW0tSGFyZHksIEJhcmxvdyBNb29yIENsdXN0ZXIgMTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZGJhMDEzMDkzZjVmNDAyY2EwZjM3Y2U2NmMwYjZhYzAuc2V0Q29udGVudChodG1sX2QxZGFjMjk0MDUyNTQ1OWU5MGZkOTg5ZmRjNTZlYzU2KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzRkMTBmMTQ2OGMzMzRiNjJiOWFjNTU2NzgzNDBkNTE3LmJpbmRQb3B1cChwb3B1cF9kYmEwMTMwOTNmNWY0MDJjYTBmMzdjZTY2YzBiNmFjMCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8zNDdjZDVkNDk4MmY0NjgzOTI4NGQ0NTQxN2NiYzFkNyA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzUzLjM5OTQwNSwtMi4yNTYxODI0ODUxMDQ0Njg1XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiM4MDAwZmYiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjODAwMGZmIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2IxYWE0OTY1OTM5YTRjMDg5NTY5M2M5MDJjODFmNDM4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzIyN2U2M2U1Y2IxZjRjMGVhMDMzMmE2M2YzZmE3MzYzID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzAzNjBiYTA2MWU4YTQwMmY5OTA1MDYyNTczOThkNTg5ID0gJCgnPGRpdiBpZD0iaHRtbF8wMzYwYmEwNjFlOGE0MDJmOTkwNTA2MjU3Mzk4ZDU4OSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+V3l0aGVuc2hhd2UsIE5vcnRoZW5kZW4sIFNoYXJzdG9uIEluZHVzdHJpYWwgQXJlYSBDbHVzdGVyIDE8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzIyN2U2M2U1Y2IxZjRjMGVhMDMzMmE2M2YzZmE3MzYzLnNldENvbnRlbnQoaHRtbF8wMzYwYmEwNjFlOGE0MDJmOTkwNTA2MjU3Mzk4ZDU4OSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8zNDdjZDVkNDk4MmY0NjgzOTI4NGQ0NTQxN2NiYzFkNy5iaW5kUG9wdXAocG9wdXBfMjI3ZTYzZTVjYjFmNGMwZWEwMzMyYTYzZjNmYTczNjMpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfMGI4ZTdiNWZiNmIyNDYyY2IwZjEyNGRiMzc2OTRmOTUgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1My41NDU1MjAxLC0yLjM2Nzg1ODRdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwMDBmZiIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MDAwZmYiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYjFhYTQ5NjU5MzlhNGMwODk1NjkzYzkwMmM4MWY0MzgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfMjk5NGM4MjA4ODA4NGNkZjljNzFmMjBhNjI0MDMzZDggPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfOTgxN2JhNmE0OTNjNDRhOWEwODU4ZTA3OWI3OGM0NTEgPSAkKCc8ZGl2IGlkPSJodG1sXzk4MTdiYTZhNDkzYzQ0YTlhMDg1OGUwNzliNzhjNDUxIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5SYWRjbGlmZmUsIFN0b25lY2xvdWdoIENsdXN0ZXIgMTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfMjk5NGM4MjA4ODA4NGNkZjljNzFmMjBhNjI0MDMzZDguc2V0Q29udGVudChodG1sXzk4MTdiYTZhNDkzYzQ0YTlhMDg1OGUwNzliNzhjNDUxKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzBiOGU3YjVmYjZiMjQ2MmNiMGYxMjRkYjM3Njk0Zjk1LmJpbmRQb3B1cChwb3B1cF8yOTk0YzgyMDg4MDg0Y2RmOWM3MWYyMGE2MjQwMzNkOCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8xZGRhODMzMWNhYWM0Mjc1YTI0MTdlZWExNTliOWFkYiA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzUzLjQ5MjM1NjMsLTIuNDUwMDk0M10sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjODBmZmI0IiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzgwZmZiNCIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9iMWFhNDk2NTkzOWE0YzA4OTU2OTNjOTAyYzgxZjQzOCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9hYmQxYWQxODBiYmQ0ZTQ5OGNhYTNiMDVmZTNiNzdjNCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9iMzA4MWFmMDQyNzY0N2MwOWE5ZjE1OTIxMzMwYTdjMyA9ICQoJzxkaXYgaWQ9Imh0bWxfYjMwODFhZjA0Mjc2NDdjMDlhOWYxNTkyMTMzMGE3YzMiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPlR5bGRlc2xleSwgQXN0bGV5IENsdXN0ZXIgMjwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfYWJkMWFkMTgwYmJkNGU0OThjYWEzYjA1ZmUzYjc3YzQuc2V0Q29udGVudChodG1sX2IzMDgxYWYwNDI3NjQ3YzA5YTlmMTU5MjEzMzBhN2MzKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzFkZGE4MzMxY2FhYzQyNzVhMjQxN2VlYTE1OWI5YWRiLmJpbmRQb3B1cChwb3B1cF9hYmQxYWQxODBiYmQ0ZTQ5OGNhYTNiMDVmZTNiNzdjNCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl81NmRkYTg3MzI3ZTc0YjAzOGEzZjZjMTgwMzUzYzYwNCA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzUzLjQzNzQ2ODM1LC0yLjQwOTU3MzMzNDA5OTEyNV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjZmYwMDAwIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiI2ZmMDAwMCIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9iMWFhNDk2NTkzOWE0YzA4OTU2OTNjOTAyYzgxZjQzOCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9mYzc4YjYyYjc2YTU0ZGM2OWY2NjQ0OGZiNTQwOTM4MSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8yOWI3NWM2ZWY4NzM0MTg1YjgwYmYzY2FhNzFhM2Q1MCA9ICQoJzxkaXYgaWQ9Imh0bWxfMjliNzVjNmVmODczNDE4NWI4MGJmM2NhYTcxYTNkNTAiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkNhcnJpbmd0b24sIFBhcnRpbmd0b24gQ2x1c3RlciAwPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9mYzc4YjYyYjc2YTU0ZGM2OWY2NjQ0OGZiNTQwOTM4MS5zZXRDb250ZW50KGh0bWxfMjliNzVjNmVmODczNDE4NWI4MGJmM2NhYTcxYTNkNTApOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfNTZkZGE4NzMyN2U3NGIwMzhhM2Y2YzE4MDM1M2M2MDQuYmluZFBvcHVwKHBvcHVwX2ZjNzhiNjJiNzZhNTRkYzY5ZjY2NDQ4ZmI1NDA5MzgxKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzY4ZTNhZGUyNjVmMDQ3ZmNhNDA2OWJkMzc5OTNmZjEyID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTMuNDQ1NDI4LC0yLjMyMjMwNTFdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwMDBmZiIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MDAwZmYiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYjFhYTQ5NjU5MzlhNGMwODk1NjkzYzkwMmM4MWY0MzgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfYzBjM2E5ZDhhZDc1NGUyMmI4OWRhZDkwNjI2YWE5MzEgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNDY0ZWIwOGM1MGJkNDNiMWE1MjM3MmY5NjE5YjY5MTQgPSAkKCc8ZGl2IGlkPSJodG1sXzQ2NGViMDhjNTBiZDQzYjFhNTIzNzJmOTYxOWI2OTE0IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5TdHJldGZvcmQgQ2x1c3RlciAxPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9jMGMzYTlkOGFkNzU0ZTIyYjg5ZGFkOTA2MjZhYTkzMS5zZXRDb250ZW50KGh0bWxfNDY0ZWIwOGM1MGJkNDNiMWE1MjM3MmY5NjE5YjY5MTQpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfNjhlM2FkZTI2NWYwNDdmY2E0MDY5YmQzNzk5M2ZmMTIuYmluZFBvcHVwKHBvcHVwX2MwYzNhOWQ4YWQ3NTRlMjJiODlkYWQ5MDYyNmFhOTMxKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2QyNjc2NDRjMDQzNDQwY2ZhYmM2NzIyMTQwNzczMTAxID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTMuNDU3NDAxOCwtMi4xMzA5NDI0XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiM4MDAwZmYiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjODAwMGZmIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2IxYWE0OTY1OTM5YTRjMDg5NTY5M2M5MDJjODFmNDM4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzUxNWJmZDRlMTM1YzQ2MWVhNjgzNzYwMWY4M2NmOGVjID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzI5YmY0ZmExMjk4NDQ3NzZiNGM2MTE0NTk1MzhiNWIzID0gJCgnPGRpdiBpZD0iaHRtbF8yOWJmNGZhMTI5ODQ0Nzc2YjRjNjExNDU5NTM4YjViMyIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+RGVudG9uLCBBdWRlbnNoYXcgQ2x1c3RlciAxPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF81MTViZmQ0ZTEzNWM0NjFlYTY4Mzc2MDFmODNjZjhlYy5zZXRDb250ZW50KGh0bWxfMjliZjRmYTEyOTg0NDc3NmI0YzYxMTQ1OTUzOGI1YjMpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfZDI2NzY0NGMwNDM0NDBjZmFiYzY3MjIxNDA3NzMxMDEuYmluZFBvcHVwKHBvcHVwXzUxNWJmZDRlMTM1YzQ2MWVhNjgzNzYwMWY4M2NmOGVjKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2JlYTY0MzQ4YzVhNjQwZWJhMmRiZDc4MjUxNDcxNzM5ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTMuNTE0OTc0OSwtMi4xNTAwMzI1XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiM4MDAwZmYiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjODAwMGZmIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2IxYWE0OTY1OTM5YTRjMDg5NTY5M2M5MDJjODFmNDM4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2FkYzQwNzNjMTk3YTRkNmJiZjZhNmZmM2QzMDZkMDM0ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2JiZTAwMzVmZTQ1MDRhOTY4YTU4NDUwODgzN2NiMTY5ID0gJCgnPGRpdiBpZD0iaHRtbF9iYmUwMDM1ZmU0NTA0YTk2OGE1ODQ1MDg4MzdjYjE2OSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+RmFpbHN3b3J0aCBDbHVzdGVyIDE8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2FkYzQwNzNjMTk3YTRkNmJiZjZhNmZmM2QzMDZkMDM0LnNldENvbnRlbnQoaHRtbF9iYmUwMDM1ZmU0NTA0YTk2OGE1ODQ1MDg4MzdjYjE2OSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9iZWE2NDM0OGM1YTY0MGViYTJkYmQ3ODI1MTQ3MTczOS5iaW5kUG9wdXAocG9wdXBfYWRjNDA3M2MxOTdhNGQ2YmJmNmE2ZmYzZDMwNmQwMzQpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNjAxODgwMDg1N2Q1NGYyNWIwZjk4MTk2ZDU2YWNjMGIgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1My41Mjc0OTM4LC0yLjQxOTg4ODNdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwMDBmZiIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MDAwZmYiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYjFhYTQ5NjU5MzlhNGMwODk1NjkzYzkwMmM4MWY0MzgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZTE5MWRiOTNhNWM1NDIzMGIwYzM3YmY2OGYxYjdhYzYgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNDhhM2UwNDMzNTE1NGU1MGE5ZTlmZmMxOTJhNWQ4NGMgPSAkKCc8ZGl2IGlkPSJodG1sXzQ4YTNlMDQzMzUxNTRlNTBhOWU5ZmZjMTkyYTVkODRjIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5MaXR0bGUgSHVsdG9uIENsdXN0ZXIgMTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZTE5MWRiOTNhNWM1NDIzMGIwYzM3YmY2OGYxYjdhYzYuc2V0Q29udGVudChodG1sXzQ4YTNlMDQzMzUxNTRlNTBhOWU5ZmZjMTkyYTVkODRjKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzYwMTg4MDA4NTdkNTRmMjViMGY5ODE5NmQ1NmFjYzBiLmJpbmRQb3B1cChwb3B1cF9lMTkxZGI5M2E1YzU0MjMwYjBjMzdiZjY4ZjFiN2FjNik7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8zNjQxNTk5NWRlNWI0MmY2YWE1OGRhN2Q2Mjk3NTViYSA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzUzLjQ0ODMyMDgsLTIuMzUzNjU2NV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjODAwMGZmIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzgwMDBmZiIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9iMWFhNDk2NTkzOWE0YzA4OTU2OTNjOTAyYzgxZjQzOCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9hZTQ1YWZmYzBlMGM0ZjZmOTcwMjU4NzQ3MmViODEzYiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF83NDY1ODg1YmZkNzM0NmIyYjEzMGVhMDQ0YTdmMjQ3MiA9ICQoJzxkaXYgaWQ9Imh0bWxfNzQ2NTg4NWJmZDczNDZiMmIxMzBlYTA0NGE3ZjI0NzIiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPlVybXN0b24sIERhdnlodWxtZSwgRmxpeHRvbiwgVHJhZmZvcmQgUGFyayBDbHVzdGVyIDE8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2FlNDVhZmZjMGUwYzRmNmY5NzAyNTg3NDcyZWI4MTNiLnNldENvbnRlbnQoaHRtbF83NDY1ODg1YmZkNzM0NmIyYjEzMGVhMDQ0YTdmMjQ3Mik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8zNjQxNTk5NWRlNWI0MmY2YWE1OGRhN2Q2Mjk3NTViYS5iaW5kUG9wdXAocG9wdXBfYWU0NWFmZmMwZTBjNGY2Zjk3MDI1ODc0NzJlYjgxM2IpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfZWNlYTBmMzY4YmVmNDk3ZmI5OTZjNzhmNTQxYjgyMjIgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs1My40Nzg2MDM0LC0yLjE0OTE5NjRdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwMDBmZiIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MDAwZmYiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYjFhYTQ5NjU5MzlhNGMwODk1NjkzYzkwMmM4MWY0MzgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZjc1YTlhYjRkYzlmNGZjMmFmZDIzMDUzNzgyZjFiZTUgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMWJmZGQ5NWJhY2I1NGVjZGI0ODBkOGUyMjI1ZjgzZjQgPSAkKCc8ZGl2IGlkPSJodG1sXzFiZmRkOTViYWNiNTRlY2RiNDgwZDhlMjIyNWY4M2Y0IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5Ecm95bHNkZW4gQ2x1c3RlciAxPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9mNzVhOWFiNGRjOWY0ZmMyYWZkMjMwNTM3ODJmMWJlNS5zZXRDb250ZW50KGh0bWxfMWJmZGQ5NWJhY2I1NGVjZGI0ODBkOGUyMjI1ZjgzZjQpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfZWNlYTBmMzY4YmVmNDk3ZmI5OTZjNzhmNTQxYjgyMjIuYmluZFBvcHVwKHBvcHVwX2Y3NWE5YWI0ZGM5ZjRmYzJhZmQyMzA1Mzc4MmYxYmU1KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzYyOTFlYWE2YzA4YTRiNGNhYTc3Yzk2ZmFlZTA1ZDk2ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTMuNDI3MTAwMywtMi40MzU1MDU0XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiNmZjAwMDAiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjZmYwMDAwIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2IxYWE0OTY1OTM5YTRjMDg5NTY5M2M5MDJjODFmNDM4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2YzMjYzN2U0NWI4NjQ2YWZhZTU4NDQyMTZkNTU0ZTQxID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2U2MTFhNmEyNDNmMjRmNDBhYTUxZjI0Yjk1N2IwZjUzID0gJCgnPGRpdiBpZD0iaHRtbF9lNjExYTZhMjQzZjI0ZjQwYWE1MWYyNGI5NTdiMGY1MyIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+SXJsYW0sIENhZGlzaGVhZCBDbHVzdGVyIDA8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2YzMjYzN2U0NWI4NjQ2YWZhZTU4NDQyMTZkNTU0ZTQxLnNldENvbnRlbnQoaHRtbF9lNjExYTZhMjQzZjI0ZjQwYWE1MWYyNGI5NTdiMGY1Myk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl82MjkxZWFhNmMwOGE0YjRjYWE3N2M5NmZhZWUwNWQ5Ni5iaW5kUG9wdXAocG9wdXBfZjMyNjM3ZTQ1Yjg2NDZhZmFlNTg0NDIxNmQ1NTRlNDEpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNzA2MjNlNjRmNmYzNGE5MjhmNTE0NGMxNDc3NzdjOGIgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFs0NC4zNzMwNTc3LC03MS42MTE4NTc3XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiM4MGZmYjQiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjODBmZmI0IiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2IxYWE0OTY1OTM5YTRjMDg5NTY5M2M5MDJjODFmNDM4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzg2ZjI3MTMyM2NkNTQ5NjhiYjc2Mzc2NzY0YzdkNWM4ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2U5NTU5ZGVkYTk4OTQ1M2NiMGI4ZjdmNGFhN2QyZjFlID0gJCgnPGRpdiBpZD0iaHRtbF9lOTU1OWRlZGE5ODk0NTNjYjBiOGY3ZjRhYTdkMmYxZSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+V2hpdGVmaWVsZCBDbHVzdGVyIDI8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzg2ZjI3MTMyM2NkNTQ5NjhiYjc2Mzc2NzY0YzdkNWM4LnNldENvbnRlbnQoaHRtbF9lOTU1OWRlZGE5ODk0NTNjYjBiOGY3ZjRhYTdkMmYxZSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl83MDYyM2U2NGY2ZjM0YTkyOGY1MTQ0YzE0Nzc3N2M4Yi5iaW5kUG9wdXAocG9wdXBfODZmMjcxMzIzY2Q1NDk2OGJiNzYzNzY3NjRjN2Q1YzgpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfMGFhY2FkM2QxOGZiNGM2OGE2MjI0NjIyODQ2MmY1NTQgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFszNy40NjEzMjcyLC0xMjIuMTk3NzQzXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogIiM4MDAwZmYiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjODAwMGZmIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2IxYWE0OTY1OTM5YTRjMDg5NTY5M2M5MDJjODFmNDM4KTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2ZlNmRlZjc2ZTZhYzRhMzRhOWVlZDc0YzkyZTU4OTg1ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2M0MWIzYWEyNzlmMDQ4YTI4NDIwOWI1ZjQzZTkwZjM5ID0gJCgnPGRpdiBpZD0iaHRtbF9jNDFiM2FhMjc5ZjA0OGEyODQyMDliNWY0M2U5MGYzOSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+QXRoZXJ0b24gQ2x1c3RlciAxPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9mZTZkZWY3NmU2YWM0YTM0YTllZWQ3NGM5MmU1ODk4NS5zZXRDb250ZW50KGh0bWxfYzQxYjNhYTI3OWYwNDhhMjg0MjA5YjVmNDNlOTBmMzkpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfMGFhY2FkM2QxOGZiNGM2OGE2MjI0NjIyODQ2MmY1NTQuYmluZFBvcHVwKHBvcHVwX2ZlNmRlZjc2ZTZhYzRhMzRhOWVlZDc0YzkyZTU4OTg1KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2NmODQ2Zjk1MGFmNTQyYjRhMjdmMmE5MjhmZmU3MDQzID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbLTMxLjA5MzI3NDYsLTY0LjQ4MjA3MzVdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwMDBmZiIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MDAwZmYiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYjFhYTQ5NjU5MzlhNGMwODk1NjkzYzkwMmM4MWY0MzgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfYTg5ZDY0YjNlYTdlNDMyZmE1YTJjODNiYjNjZTE2YWIgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMjNjN2ZhZTM1OTIzNDk2OTkyMjM5NDYwZjhjMzA3MTEgPSAkKCc8ZGl2IGlkPSJodG1sXzIzYzdmYWUzNTkyMzQ5Njk5MjIzOTQ2MGY4YzMwNzExIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5NYW5jaGVzdGVyIFggQ2x1c3RlciAxPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9hODlkNjRiM2VhN2U0MzJmYTVhMmM4M2JiM2NlMTZhYi5zZXRDb250ZW50KGh0bWxfMjNjN2ZhZTM1OTIzNDk2OTkyMjM5NDYwZjhjMzA3MTEpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfY2Y4NDZmOTUwYWY1NDJiNGEyN2YyYTkyOGZmZTcwNDMuYmluZFBvcHVwKHBvcHVwX2E4OWQ2NGIzZWE3ZTQzMmZhNWEyYzgzYmIzY2UxNmFiKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2Y0MzRmNzRkMDkyNDQ1ZDE5NTc5ZjZjZGFiYjc5YjRjID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbLTMxLjA5MzI3NDYsLTY0LjQ4MjA3MzVdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiIzgwMDBmZiIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiM4MDAwZmYiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYjFhYTQ5NjU5MzlhNGMwODk1NjkzYzkwMmM4MWY0MzgpOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfMzI2ODFiODVlZTdmNDE3YmJiNWYzNTAxMjc1NmM1NGIgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfYWY0YmM3YWU1YmE4NDkyODgyODAyMWZjMDYwNGYyMGQgPSAkKCc8ZGl2IGlkPSJodG1sX2FmNGJjN2FlNWJhODQ5Mjg4MjgwMjFmYzA2MDRmMjBkIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5NYW5jaGVzdGVyIFggQ2x1c3RlciAxPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8zMjY4MWI4NWVlN2Y0MTdiYmI1ZjM1MDEyNzU2YzU0Yi5zZXRDb250ZW50KGh0bWxfYWY0YmM3YWU1YmE4NDkyODgyODAyMWZjMDYwNGYyMGQpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfZjQzNGY3NGQwOTI0NDVkMTk1NzlmNmNkYWJiNzliNGMuYmluZFBvcHVwKHBvcHVwXzMyNjgxYjg1ZWU3ZjQxN2JiYjVmMzUwMTI3NTZjNTRiKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2JiYzM4NDY5MDhlMTQ3MmJhM2M2NGEyMzRmM2E3YjY5ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbNTMuMzUwMzQyMDQ5OTk5OTk1LC0yLjI4MDM2OTI1MjY2NDI5NV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICIjODAwMGZmIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzgwMDBmZiIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9iMWFhNDk2NTkzOWE0YzA4OTU2OTNjOTAyYzgxZjQzOCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9iZmJjZDdlODg3ZWE0OTMyOGNjY2YzYmViMmEwNDM5NyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8wZjc5MGQ3NzNjNzk0Y2ZjOGExZDkwZWJkMTg4ODI0NCA9ICQoJzxkaXYgaWQ9Imh0bWxfMGY3OTBkNzczYzc5NGNmYzhhMWQ5MGViZDE4ODgyNDQiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPk1hbmNoZXN0ZXIgQWlycG9ydCBDbHVzdGVyIDE8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2JmYmNkN2U4ODdlYTQ5MzI4Y2NjZjNiZWIyYTA0Mzk3LnNldENvbnRlbnQoaHRtbF8wZjc5MGQ3NzNjNzk0Y2ZjOGExZDkwZWJkMTg4ODI0NCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9iYmMzODQ2OTA4ZTE0NzJiYTNjNjRhMjM0ZjNhN2I2OS5iaW5kUG9wdXAocG9wdXBfYmZiY2Q3ZTg4N2VhNDkzMjhjY2NmM2JlYjJhMDQzOTcpOwoKICAgICAgICAgICAgCiAgICAgICAgCjwvc2NyaXB0Pg== onload=\"this.contentDocument.open();this.contentDocument.write(atob(this.getAttribute('data-html')));this.contentDocument.close();\" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>",
                        "text/plain": "<folium.folium.Map at 0x7f2be764aac8>"
                    },
                    "execution_count": 45,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "man_onehot = pd.get_dummies(man_venues[['Venue Category']], prefix=\"\", prefix_sep=\"\")\nman_onehot['Neighborhood'] = man['Neighborhood'] \nman_onehot.set_index(\"Neighborhood\",inplace=True)\nman_grouped = man_onehot.groupby('Neighborhood').mean().reset_index()\ndef return_most_common_venues(row, num_top_venues):\n    row_categories = row.iloc[1:]\n    row_categories_sorted = row_categories.sort_values(ascending=False)   \n    return row_categories_sorted.index.values[0:num_top_venues]\nnum_top_venues = 10\nindicators = ['st', 'nd', 'rd']\ncolumns = ['Neighborhood']\nfor ind in np.arange(num_top_venues):\n    try:\n        columns.append('{}{} Most Common Venue'.format(ind+1, indicators[ind]))\n    except:\n        columns.append('{}th Most Common Venue'.format(ind+1))\nneighborhoods_venues_sorted = pd.DataFrame(columns=columns)\nneighborhoods_venues_sorted['Neighborhood'] = man_grouped['Neighborhood']\nfor ind in np.arange(man_grouped.shape[0]):\n    neighborhoods_venues_sorted.iloc[ind, 1:] = return_most_common_venues(man_grouped.iloc[ind, :], num_top_venues)\n\nkclusters = 3\nman_grouped_clustering = man_grouped.drop('Neighborhood', 1)\nkmeans = KMeans(n_clusters=kclusters, random_state=0).fit(man_grouped_clustering)\n\nif \"Cluster Labels\" in neighborhoods_venues_sorted.columns:\n    neighborhoods_venues_sorted = neighborhoods_venues_sorted.drop('Cluster Labels', axis=1)\nneighborhoods_venues_sorted.insert(0, 'Cluster Labels', kmeans.labels_)\nman_merged = man\nman_merged = man_merged.join(neighborhoods_venues_sorted.set_index('Neighborhood'), on='Neighborhood')\n\n# Manchester's coordinates\nlat = 53.4808\nlon = -2.2426\nmap_clusters = folium.Map(location=[lat,lon], zoom_start=10)\n\n# set color scheme for the clusters\nx = np.arange(kclusters)\nys = [i + x + (i*x)**2 for i in range(kclusters)]\ncolors_array = cm.rainbow(np.linspace(0, 1, len(ys)))\nrainbow = [colors.rgb2hex(i) for i in colors_array]\n\n# add markers to the map\nmarkers_colors = []\nfor lat, lon, poi, cluster in zip(man_merged['latitude'], man_merged['longitude'], man_merged['Neighborhood'], man_merged['Cluster Labels']):\n    label = folium.Popup(str(poi) + ' Cluster ' + str(cluster), parse_html=True)\n    folium.CircleMarker(\n        [lat, lon],\n        radius=5,\n        popup=label,\n        color=rainbow[cluster-1],\n        fill=True,\n        fill_color=rainbow[cluster-1],\n        fill_opacity=0.7).add_to(map_clusters)\n       \nmap_clusters"
        },
        {
            "cell_type": "code",
            "execution_count": 46,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Neighborhood</th>\n      <th>1st Most Common Venue</th>\n      <th>2nd Most Common Venue</th>\n      <th>3rd Most Common Venue</th>\n      <th>4th Most Common Venue</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>18</th>\n      <td>Levenshulme, Burnage</td>\n      <td>Pub</td>\n      <td>Yoga Studio</td>\n      <td>Furniture / Home Store</td>\n      <td>Fabric Shop</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>Carrington, Partington</td>\n      <td>Pub</td>\n      <td>Yoga Studio</td>\n      <td>Furniture / Home Store</td>\n      <td>Fabric Shop</td>\n    </tr>\n    <tr>\n      <th>39</th>\n      <td>Irlam, Cadishead</td>\n      <td>Pub</td>\n      <td>Yoga Studio</td>\n      <td>Furniture / Home Store</td>\n      <td>Fabric Shop</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "              Neighborhood 1st Most Common Venue 2nd Most Common Venue  \\\n18    Levenshulme, Burnage                   Pub           Yoga Studio   \n30  Carrington, Partington                   Pub           Yoga Studio   \n39        Irlam, Cadishead                   Pub           Yoga Studio   \n\n     3rd Most Common Venue 4th Most Common Venue  \n18  Furniture / Home Store           Fabric Shop  \n30  Furniture / Home Store           Fabric Shop  \n39  Furniture / Home Store           Fabric Shop  "
                    },
                    "execution_count": 46,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "m1 = man_merged.loc[man_merged['Cluster Labels'] == 0, :]\nm1 = m1[['Neighborhood','1st Most Common Venue','2nd Most Common Venue','3rd Most Common Venue','4th Most Common Venue']]\nm1"
        },
        {
            "cell_type": "code",
            "execution_count": 47,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Neighborhood</th>\n      <th>1st Most Common Venue</th>\n      <th>2nd Most Common Venue</th>\n      <th>3rd Most Common Venue</th>\n      <th>4th Most Common Venue</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Piccadilly, City Centre, Market Street</td>\n      <td>Sandwich Place</td>\n      <td>Yoga Studio</td>\n      <td>Furniture / Home Store</td>\n      <td>Fabric Shop</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>City Centre, Deansgate, Castlefield</td>\n      <td>Burger Joint</td>\n      <td>Gastropub</td>\n      <td>Falafel Restaurant</td>\n      <td>Farmers Market</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Crumpsall, Cheetham Hill</td>\n      <td>Market</td>\n      <td>Yoga Studio</td>\n      <td>Gas Station</td>\n      <td>Fabric Shop</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Harpurhey, Blackley</td>\n      <td>Coffee Shop</td>\n      <td>Yoga Studio</td>\n      <td>Gas Station</td>\n      <td>Falafel Restaurant</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Trafford Park, The Trafford Centre</td>\n      <td>Ramen Restaurant</td>\n      <td>Furniture / Home Store</td>\n      <td>Electronics Store</td>\n      <td>Fabric Shop</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>Didsbury, Withington</td>\n      <td>Tea Room</td>\n      <td>Yoga Studio</td>\n      <td>Gas Station</td>\n      <td>Fabric Shop</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>Chorlton-cum-Hardy, Barlow Moor</td>\n      <td>Taco Place</td>\n      <td>Yoga Studio</td>\n      <td>Gas Station</td>\n      <td>Fabric Shop</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>Wythenshawe, Northenden, Sharston Industrial Area</td>\n      <td>Indian Restaurant</td>\n      <td>Yoga Studio</td>\n      <td>Gas Station</td>\n      <td>Fabric Shop</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>Radcliffe, Stoneclough</td>\n      <td>Caf\u00e9</td>\n      <td>Yoga Studio</td>\n      <td>Gas Station</td>\n      <td>Falafel Restaurant</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>Stretford</td>\n      <td>Hotel</td>\n      <td>Gas Station</td>\n      <td>Fabric Shop</td>\n      <td>Falafel Restaurant</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>Denton, Audenshaw</td>\n      <td>Mini Golf</td>\n      <td>Gas Station</td>\n      <td>Fabric Shop</td>\n      <td>Falafel Restaurant</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>Failsworth</td>\n      <td>Multiplex</td>\n      <td>Yoga Studio</td>\n      <td>Fabric Shop</td>\n      <td>Falafel Restaurant</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>Little Hulton</td>\n      <td>Spanish Restaurant</td>\n      <td>Yoga Studio</td>\n      <td>Furniture / Home Store</td>\n      <td>Fabric Shop</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>Urmston, Davyhulme, Flixton, Trafford Park</td>\n      <td>Hotel</td>\n      <td>Gas Station</td>\n      <td>Fabric Shop</td>\n      <td>Falafel Restaurant</td>\n    </tr>\n    <tr>\n      <th>38</th>\n      <td>Droylsden</td>\n      <td>Comedy Club</td>\n      <td>Yoga Studio</td>\n      <td>Gas Station</td>\n      <td>Falafel Restaurant</td>\n    </tr>\n    <tr>\n      <th>41</th>\n      <td>Atherton</td>\n      <td>Gastropub</td>\n      <td>Gas Station</td>\n      <td>Fabric Shop</td>\n      <td>Falafel Restaurant</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>Manchester X</td>\n      <td>Science Museum</td>\n      <td>Cocktail Bar</td>\n      <td>Yoga Studio</td>\n      <td>Donut Shop</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>Manchester X</td>\n      <td>Science Museum</td>\n      <td>Cocktail Bar</td>\n      <td>Yoga Studio</td>\n      <td>Donut Shop</td>\n    </tr>\n    <tr>\n      <th>50</th>\n      <td>Manchester Airport</td>\n      <td>Restaurant</td>\n      <td>Furniture / Home Store</td>\n      <td>Electronics Store</td>\n      <td>Fabric Shop</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "                                         Neighborhood 1st Most Common Venue  \\\n0              Piccadilly, City Centre, Market Street        Sandwich Place   \n2                 City Centre, Deansgate, Castlefield          Burger Joint   \n8                            Crumpsall, Cheetham Hill                Market   \n9                                 Harpurhey, Blackley           Coffee Shop   \n16                 Trafford Park, The Trafford Centre      Ramen Restaurant   \n19                               Didsbury, Withington              Tea Room   \n20                    Chorlton-cum-Hardy, Barlow Moor            Taco Place   \n21  Wythenshawe, Northenden, Sharston Industrial Area     Indian Restaurant   \n25                             Radcliffe, Stoneclough                  Caf\u00e9   \n31                                          Stretford                 Hotel   \n33                                  Denton, Audenshaw             Mini Golf   \n34                                         Failsworth             Multiplex   \n35                                      Little Hulton    Spanish Restaurant   \n37         Urmston, Davyhulme, Flixton, Trafford Park                 Hotel   \n38                                          Droylsden           Comedy Club   \n41                                           Atherton             Gastropub   \n47                                       Manchester X        Science Museum   \n49                                       Manchester X        Science Museum   \n50                                 Manchester Airport            Restaurant   \n\n     2nd Most Common Venue   3rd Most Common Venue 4th Most Common Venue  \n0              Yoga Studio  Furniture / Home Store           Fabric Shop  \n2                Gastropub      Falafel Restaurant        Farmers Market  \n8              Yoga Studio             Gas Station           Fabric Shop  \n9              Yoga Studio             Gas Station    Falafel Restaurant  \n16  Furniture / Home Store       Electronics Store           Fabric Shop  \n19             Yoga Studio             Gas Station           Fabric Shop  \n20             Yoga Studio             Gas Station           Fabric Shop  \n21             Yoga Studio             Gas Station           Fabric Shop  \n25             Yoga Studio             Gas Station    Falafel Restaurant  \n31             Gas Station             Fabric Shop    Falafel Restaurant  \n33             Gas Station             Fabric Shop    Falafel Restaurant  \n34             Yoga Studio             Fabric Shop    Falafel Restaurant  \n35             Yoga Studio  Furniture / Home Store           Fabric Shop  \n37             Gas Station             Fabric Shop    Falafel Restaurant  \n38             Yoga Studio             Gas Station    Falafel Restaurant  \n41             Gas Station             Fabric Shop    Falafel Restaurant  \n47            Cocktail Bar             Yoga Studio            Donut Shop  \n49            Cocktail Bar             Yoga Studio            Donut Shop  \n50  Furniture / Home Store       Electronics Store           Fabric Shop  "
                    },
                    "execution_count": 47,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "m2 = man_merged.loc[man_merged['Cluster Labels'] == 1, :]\nm2 = m2[['Neighborhood','1st Most Common Venue','2nd Most Common Venue','3rd Most Common Venue','4th Most Common Venue']]\nm2"
        },
        {
            "cell_type": "code",
            "execution_count": 48,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Neighborhood</th>\n      <th>1st Most Common Venue</th>\n      <th>2nd Most Common Venue</th>\n      <th>3rd Most Common Venue</th>\n      <th>4th Most Common Venue</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>Deansgate, City Centre</td>\n      <td>Bar</td>\n      <td>Yoga Studio</td>\n      <td>Gastropub</td>\n      <td>Falafel Restaurant</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>Tyldesley, Astley</td>\n      <td>Bar</td>\n      <td>Yoga Studio</td>\n      <td>Gastropub</td>\n      <td>Falafel Restaurant</td>\n    </tr>\n    <tr>\n      <th>40</th>\n      <td>Whitefield</td>\n      <td>Bar</td>\n      <td>Yoga Studio</td>\n      <td>Gastropub</td>\n      <td>Falafel Restaurant</td>\n    </tr>\n  </tbody>\n</table>\n</div>",
                        "text/plain": "              Neighborhood 1st Most Common Venue 2nd Most Common Venue  \\\n1   Deansgate, City Centre                   Bar           Yoga Studio   \n28       Tyldesley, Astley                   Bar           Yoga Studio   \n40              Whitefield                   Bar           Yoga Studio   \n\n   3rd Most Common Venue 4th Most Common Venue  \n1              Gastropub    Falafel Restaurant  \n28             Gastropub    Falafel Restaurant  \n40             Gastropub    Falafel Restaurant  "
                    },
                    "execution_count": 48,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "m3 = man_merged.loc[man_merged['Cluster Labels'] == 2, :]\nm3 = m3[['Neighborhood','1st Most Common Venue','2nd Most Common Venue','3rd Most Common Venue','4th Most Common Venue']]\nm3"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Observations\n\n- If you want close access to a Bar and a Flea Market, check out Deansgate, Tyldesly and Whitefield.\n- If you're just visiting Manchester and want to live in a hotel, check out Stretford and Trafford Park.\n- If you're a Vegan, almost all neighborhoods will be fine."
        }
    ],
    "metadata": {
        "kernelspec": {
            "display_name": "Python 3.6",
            "language": "python",
            "name": "python3"
        },
        "language_info": {
            "codemirror_mode": {
                "name": "ipython",
                "version": 3
            },
            "file_extension": ".py",
            "mimetype": "text/x-python",
            "name": "python",
            "nbconvert_exporter": "python",
            "pygments_lexer": "ipython3",
            "version": "3.6.9"
        }
    },
    "nbformat": 4,
    "nbformat_minor": 1
}